<!doctype html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <meta name="filename" content="MarginNote_Literature_Manager.html">
  <title>MarginNote æ–‡çŒ®ç®¡ç†ç³»ç»Ÿ</title>
  <style>
    :root {
      --bg: #f7f8fb;
      --card-bg: #fff;
      --accent: #2b7cff;
      --muted: #666;
      --shadow: 0 1px 3px rgba(0, 0, 0, 0.08);
      --topbar-height: 64px;
      --tabs-height: 52px;
      --filter-height: 0px;

      /* æ–‡çŒ®ç±»å‹é¢œè‰² */
      --article-color: #5569ff;
      --conference-color: #ff9d4d;
      --book-color: #a36bff;
      --thesis-color: #5bd0a9;
      --other-color: #b7c2d0;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html,
    body {
      height: 100%;
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: var(--bg);
      color: #111;
      -webkit-font-smoothing: antialiased;
      touch-action: manipulation;
      overscroll-behavior: contain;
    }

    /* ========== å›ºå®šé¡¶æ  ========== */
    .topbar {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 130;
      backdrop-filter: blur(6px);
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.98), rgba(250, 250, 250, 0.9));
      border-bottom: 1px solid #e6e9ef;
      padding: 14px 20px;
      display: flex;
      gap: 12px;
      align-items: center;
      flex-wrap: wrap;
      min-height: var(--topbar-height);
      transition: transform 0.3s ease;
    }

    .topbar-main {
      flex: 1 1 640px;
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
      min-width: 0;
    }

    .topbar-actions {
      display: flex;
      gap: 8px;
      align-items: center;
      flex-wrap: wrap;
    }

    .search-input-wrap {
      display: flex;
      gap: 8px;
      align-items: center;
      flex: 1;
      min-width: 240px;
    }

    .search-input {
      flex: 1;
      padding: 10px 14px;
      border-radius: 10px;
      border: 1px solid #d6dbe8;
      background: var(--card-bg);
      box-shadow: var(--shadow);
      font-size: 15px;
      outline: none;
      transition: all 0.2s ease;
    }

    .search-input:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px rgba(43, 124, 255, 0.1);
    }

    .search-count {
      color: var(--muted);
      font-size: 13px;
      white-space: nowrap;
    }

    .btn {
      background: var(--card-bg);
      border: 1px solid #e3e6ee;
      padding: 8px 14px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s ease;
      white-space: nowrap;
    }

    .btn:hover {
      background: #f7f9fc;
      border-color: var(--accent);
    }

    .btn:active {
      transform: scale(0.97);
    }

    .btn.primary {
      background: var(--accent);
      color: #fff;
      border-color: transparent;
      box-shadow: 0 4px 12px rgba(43, 124, 255, 0.2);
    }

    .btn.primary:hover {
      background: #1b6cef;
    }

    .btn.ghost {
      background: transparent;
      border-color: transparent;
      color: #4d5e78;
      box-shadow: none;
    }

    .btn.ghost:hover {
      background: rgba(43, 124, 255, 0.08);
      border-color: rgba(43, 124, 255, 0.12);
      color: #2b7cff;
    }

    /* ========== ç­›é€‰é¢æ¿ ========== */
    .filters-panel {
      position: fixed;
      top: var(--topbar-height);
      left: 0;
      right: 0;
      z-index: 80;
      background: rgba(247, 248, 251, 0.95);
      backdrop-filter: blur(4px);
      padding: 12px 20px;
      border-bottom: 1px solid #e6e9ef;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease, padding 0.3s ease;
    }

    .filters-panel.show {
      max-height: 500px;
      padding: 16px 20px;
    }

    .filter-section {
      margin-bottom: 14px;
    }

    .filter-section:last-child {
      margin-bottom: 0;
    }

    .filter-label {
      font-size: 12px;
      font-weight: 600;
      color: #5b6a80;
      margin-bottom: 8px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .filter-label::before {
      content: '';
      width: 6px;
      height: 6px;
      border-radius: 50%;
      background: currentColor;
      opacity: 0.45;
    }

    .pill-row {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
      align-items: center;
    }

    .pill {
      background: #eef5ff;
      color: #2f4a8a;
      border-radius: 999px;
      padding: 6px 14px;
      font-size: 13px;
      cursor: pointer;
      border: 1px solid transparent;
      transition: all 0.2s ease;
      user-select: none;
      white-space: nowrap;
    }

    .pill:hover {
      background: #e0efff;
      transform: translateY(-1px);
    }

    .pill.active {
      background: var(--accent);
      color: #fff;
      border-color: rgba(43, 124, 255, 0.6);
      box-shadow: 0 4px 12px rgba(43, 124, 255, 0.18);
    }

    /* å¹´ä»½èŒƒå›´æ»‘å— */
    .year-range-slider {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 8px;
    }

    .year-range-slider input[type="range"] {
      flex: 1;
      height: 6px;
      background: #d6dbe8;
      border-radius: 3px;
      outline: none;
      -webkit-appearance: none;
    }

    .year-range-slider input[type="range"]::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      background: var(--accent);
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 2px 6px rgba(43, 124, 255, 0.3);
    }

    .year-label {
      font-size: 13px;
      font-weight: 600;
      color: var(--accent);
      min-width: 40px;
      text-align: center;
    }

    /* ========== ä¸»å†…å®¹åŒº ========== */
    .main-layout {
      padding-top: calc(var(--topbar-height) + var(--tabs-height));
      height: 100vh;
      overflow-y: auto;
      -webkit-overflow-scrolling: touch;
    }

    .main-layout.with-filters {
      padding-top: calc(var(--topbar-height) + var(--tabs-height) + var(--filter-height));
    }

    .container {
      padding: 16px 20px 80px;
      max-width: 1600px;
      margin: 0 auto;
    }

    /* ========== æ–‡çŒ®å¡ç‰‡ç½‘æ ¼ ========== */
    .literature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      gap: 16px;
      margin-top: 16px;
    }

    .literature-card {
      background: var(--card-bg);
      border-radius: 12px;
      padding: 16px;
      box-shadow: var(--shadow);
      border-left: 4px solid var(--other-color);
      cursor: pointer;
      transition: all 0.25s ease;
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .literature-card:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
    }

    .literature-card.selected {
      border-left-width: 8px;
      box-shadow: 0 12px 28px rgba(43, 124, 255, 0.3), 0 0 0 3px rgba(43, 124, 255, 0.1);
      transform: translateY(-4px) scale(1.01);
      background: linear-gradient(135deg, rgba(43, 124, 255, 0.02), rgba(255, 255, 255, 1));
      animation: pulseSelection 0.5s ease-out;
    }

    @keyframes pulseSelection {
      0% {
        box-shadow: 0 12px 28px rgba(43, 124, 255, 0.3), 0 0 0 0 rgba(43, 124, 255, 0.3);
      }
      50% {
        box-shadow: 0 12px 28px rgba(43, 124, 255, 0.3), 0 0 0 8px rgba(43, 124, 255, 0);
      }
      100% {
        box-shadow: 0 12px 28px rgba(43, 124, 255, 0.3), 0 0 0 3px rgba(43, 124, 255, 0.1);
      }
    }

    .literature-card.expanded {
      grid-column: 1 / -1;
      max-width: 900px;
      margin: 0 auto;
      position: relative;
      z-index: 100;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    /* å¡ç‰‡æ“ä½œå›¾æ ‡ - iPad å‹å¥½,å§‹ç»ˆå¯è§ */
    .card-actions {
      position: absolute;
      top: 12px;
      right: 12px;
      display: flex;
      gap: 8px;
      opacity: 1;  /* å§‹ç»ˆå¯è§ */
    }

    .action-icon {
      width: 40px;  /* åŠ å¤§è§¦æ‘¸åŒºåŸŸ */
      height: 40px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: rgba(255, 255, 255, 0.95);
      border-radius: 50%;
      cursor: pointer;
      font-size: 16px;  /* å›¾æ ‡ç¨å¤§ */
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      transition: transform 0.2s ease;
    }

    .action-icon:active {
      transform: scale(0.9);  /* è§¦æ‘¸åé¦ˆ */
    }

    /* å¡ç‰‡å¤´éƒ¨ */
    .card-header {
      padding-right: 140px;  /* ä¸º3ä¸ªæŒ‰é’®ç•™å‡ºç©ºé—´ */
    }

    .card-type-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 10px;
      border-radius: 6px;
      font-size: 11px;
      font-weight: 600;
      color: #fff;
      margin-bottom: 8px;
    }

    .card-title {
      font-size: 16px;
      font-weight: 600;
      line-height: 1.4;
      color: #2c3e50;
      margin-bottom: 8px;
      word-break: break-word;
    }

    .card-authors {
      font-size: 13px;
      color: #5b6a80;
      margin-bottom: 4px;
    }

    .card-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      flex-wrap: wrap;
      font-size: 12px;
      color: var(--muted);
    }

    .meta-item {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .meta-divider {
      width: 1px;
      height: 12px;
      background: #d6dbe8;
    }

    .card-keywords {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 8px;
    }

    .keyword-tag {
      padding: 3px 10px;
      background: rgba(43, 124, 255, 0.08);
      color: var(--accent);
      border-radius: 12px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      user-select: none;
    }

    .keyword-tag:hover {
      background: rgba(43, 124, 255, 0.15);
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(43, 124, 255, 0.2);
    }

    .keyword-tag:active {
      transform: translateY(0);
    }

    .keyword-tag.search-active {
      background: var(--accent);
      color: #fff;
      box-shadow: 0 2px 8px rgba(43, 124, 255, 0.3);
    }

    /* å±•å¼€çš„è¯¦æƒ… */
    .card-details {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .literature-card.expanded .card-details {
      max-height: 1000px;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid #e6e9ef;
    }

    .detail-section {
      margin-bottom: 12px;
    }

    .detail-label {
      font-size: 12px;
      font-weight: 600;
      color: #5b6a80;
      margin-bottom: 6px;
    }

    .detail-content {
      font-size: 14px;
      line-height: 1.6;
      color: #2c3e50;
    }

    .detail-actions {
      display: flex;
      gap: 8px;
      margin-top: 12px;
      padding-top: 12px;
      border-top: 1px solid #e6e9ef;
    }

    /* ========== ç©ºçŠ¶æ€ ========== */
    .empty-state {
      text-align: center;
      padding: 60px 20px;
      color: var(--muted);
    }

    .empty-state i {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.3;
    }

    .empty-state h3 {
      font-size: 18px;
      margin-bottom: 8px;
    }

    .empty-state p {
      font-size: 14px;
    }

    /* ========== åŠ è½½æ›´å¤š ========== */
    .load-more-container {
      text-align: center;
      padding: 24px 0;
      display: none;
    }

    .load-more-container.show {
      display: block;
    }

    /* ========== Toast æç¤º ========== */
    .toast {
      position: fixed;
      bottom: 24px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(33, 33, 33, 0.88);
      color: #fff;
      padding: 10px 18px;
      border-radius: 999px;
      font-size: 13px;
      box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.25s ease;
      z-index: 200;
    }

    .toast.show {
      opacity: 1;
    }

    /* ========== èƒŒæ™¯æ¨¡ç³Šé®ç½© ========== */
    .backdrop-blur {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background: rgba(247, 248, 251, 0.7);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      z-index: 90;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .backdrop-blur.show {
      opacity: 1;
      pointer-events: auto;
    }

    /* ========== æ˜Ÿæ ‡åŠŸèƒ½æ ·å¼ ========== */
    .action-icon.pin-icon {
      color: #fbbf24;
    }

    .action-icon.pin-icon.pinned {
      color: #f59e0b;
      background: rgba(251, 191, 36, 0.15);
    }

    /* ========== Tabå¯¼èˆªæ  ========== */
    .view-tabs {
      position: fixed;
      top: var(--topbar-height);
      left: 0;
      right: 0;
      z-index: 120;
      background: #fff;
      border-bottom: 1px solid #e6e9ef;
      display: flex;
      padding: 0 20px;
      gap: 4px;
    }

    .tab {
      padding: 14px 20px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
      color: #5b6a80;
      border-bottom: 3px solid transparent;
      transition: all 0.2s ease;
      user-select: none;
    }

    .tab.active {
      color: var(--accent);
      border-bottom-color: var(--accent);
    }

    .tab.disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    .tab:not(.disabled):active {
      transform: scale(0.95);
    }

    /* ========== ä½œè€…è§†å›¾æ ·å¼ ========== */
    .author-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      gap: 20px;
      margin-top: 16px;
    }

    .author-card {
      background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 2px solid transparent;
      display: flex;
      flex-direction: column;
      gap: 16px;
      position: relative;
      overflow: hidden;
    }

    .author-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .author-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 24px rgba(102, 126, 234, 0.2);
      border-color: rgba(102, 126, 234, 0.3);
    }

    .author-card:hover::before {
      opacity: 1;
    }

    .author-card.selected {
      border-color: #667eea;
      box-shadow: 0 12px 28px rgba(102, 126, 234, 0.3);
      background: linear-gradient(135deg, #f0f3ff 0%, #ffffff 100%);
    }

    .author-card.expanded {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 800px;
      max-height: 85vh;
      overflow-y: auto;
      overflow-x: hidden;
      z-index: 150;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: authorCardExpand 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      -webkit-overflow-scrolling: touch;  /* iOS å¹³æ»‘æ»šåŠ¨ */
    }

    @keyframes authorCardExpand {
      from {
        transform: translate(-50%, -50%) scale(0.9);
        opacity: 0;
      }
      to {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
    }

    .author-card-header {
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .author-avatar {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-size: 24px;
      font-weight: 700;
      flex-shrink: 0;
      box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
      transition: transform 0.3s ease;
    }

    .author-card:hover .author-avatar {
      transform: scale(1.1);
    }

    .author-info {
      flex: 1;
      min-width: 0;
    }

    .author-name {
      font-size: 18px;
      font-weight: 600;
      color: #2c3e50;
      margin-bottom: 4px;
      word-break: break-word;
    }

    .author-role {
      font-size: 12px;
      color: #667eea;
      font-weight: 500;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .author-stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
      gap: 12px;
      padding: 16px;
      background: rgba(102, 126, 234, 0.05);
      border-radius: 12px;
    }

    .author-stat-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: 8px;
    }

    .author-stat-value {
      font-size: 20px;
      font-weight: 700;
      color: #667eea;
    }

    .author-stat-label {
      font-size: 11px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .author-close-btn {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: rgba(0, 0, 0, 0.1);
      display: none;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 20px;
      transition: all 0.2s ease;
      z-index: 1;
    }

    .author-card.expanded .author-close-btn {
      display: flex;
    }

    .author-close-btn:hover {
      background: rgba(0, 0, 0, 0.2);
      transform: scale(1.1);
    }

    .author-close-btn:active {
      transform: scale(0.95);
    }

    /* ä½œè€…å¡ç‰‡è¯¦æƒ…åŒºåŸŸ */
    .author-card-details {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .author-card.expanded .author-card-details {
      max-height: none;  /* ç§»é™¤é«˜åº¦é™åˆ¶ï¼Œè‡ªåŠ¨é€‚åº”å†…å®¹ */
      overflow: visible;  /* å…è®¸å†…å®¹æ˜¾ç¤ºï¼Œä¸è£å‰ª */
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid rgba(102, 126, 234, 0.2);
    }

    /* è‡ªå®šä¹‰æ»šåŠ¨æ¡æ ·å¼ */
    .author-card.expanded::-webkit-scrollbar {
      width: 8px;
    }

    .author-card.expanded::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.05);
      border-radius: 4px;
    }

    .author-card.expanded::-webkit-scrollbar-thumb {
      background: rgba(102, 126, 234, 0.3);
      border-radius: 4px;
    }

    .author-card.expanded::-webkit-scrollbar-thumb:hover {
      background: rgba(102, 126, 234, 0.5);
    }

    .detail-section {
      margin-bottom: 20px;
    }

    .detail-section:last-child {
      margin-bottom: 0;
    }

    .detail-section h4 {
      font-size: 14px;
      font-weight: 600;
      color: #667eea;
      margin-bottom: 12px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .detail-section h4::before {
      content: '';
      width: 4px;
      height: 14px;
      background: linear-gradient(180deg, #667eea, #764ba2);
      border-radius: 2px;
    }

    /* ç ”ç©¶è¶‹åŠ¿å›¾è¡¨ */
    .author-trend-chart {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 12px;
      background: rgba(102, 126, 234, 0.03);
      border-radius: 8px;
    }

    .trend-bar {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 12px;
    }

    .trend-year {
      width: 50px;
      color: var(--muted);
      font-weight: 600;
    }

    .trend-bar-container {
      flex: 1;
      height: 20px;
      background: rgba(102, 126, 234, 0.1);
      border-radius: 4px;
      overflow: hidden;
      position: relative;
    }

    .trend-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea, #764ba2);
      border-radius: 4px;
      transition: width 0.5s ease;
    }

    .trend-count {
      width: 50px;
      text-align: right;
      color: #667eea;
      font-weight: 600;
    }

    /* å…³é”®è¯æ ‡ç­¾äº‘ */
    .author-keywords {
      display: flex;
      flex-wrap: wrap;
      gap: 8px;
    }

    .author-keyword-tag {
      padding: 6px 12px;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      color: #667eea;
      border-radius: 16px;
      font-size: 12px;
      font-weight: 500;
      border: 1px solid rgba(102, 126, 234, 0.2);
      display: flex;
      align-items: center;
      gap: 4px;
      transition: all 0.2s ease;
    }

    .author-keyword-tag:hover {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.2), rgba(118, 75, 162, 0.2));
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(102, 126, 234, 0.2);
    }

    .keyword-count {
      font-size: 10px;
      padding: 2px 6px;
      background: rgba(102, 126, 234, 0.2);
      border-radius: 8px;
    }

    /* æ–‡çŒ®åˆ—è¡¨é¢„è§ˆ */
    .author-lit-preview {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .author-lit-item {
      padding: 10px 12px;
      background: rgba(102, 126, 234, 0.03);
      border-radius: 8px;
      border-left: 3px solid #667eea;
      font-size: 13px;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .author-lit-item:hover {
      background: rgba(102, 126, 234, 0.08);
      transform: translateX(4px);
    }

    .author-lit-title {
      color: #2c3e50;
      font-weight: 500;
      margin-bottom: 4px;
      line-height: 1.4;
    }

    .author-lit-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 11px;
      color: var(--muted);
    }

    /* åˆä½œè€…åˆ—è¡¨ */
    .author-coauthors {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .coauthor-item {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 8px 12px;
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.05), rgba(118, 75, 162, 0.05));
      border-radius: 20px;
      border: 1px solid rgba(102, 126, 234, 0.15);
      font-size: 12px;
      transition: all 0.2s ease;
      cursor: pointer;
    }

    .coauthor-item:hover {
      background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
      transform: translateY(-1px);
      box-shadow: 0 2px 4px rgba(102, 126, 234, 0.15);
    }

    .coauthor-avatar {
      width: 24px;
      height: 24px;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea, #764ba2);
      color: white;
      font-size: 10px;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .coauthor-name {
      color: #2c3e50;
      font-weight: 500;
    }

    .coauthor-count {
      color: #667eea;
      font-size: 11px;
    }

    /* æœŸåˆŠåˆ†å¸ƒ */
    .author-journals {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .journal-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 8px 10px;
      background: rgba(102, 126, 234, 0.03);
      border-radius: 6px;
      font-size: 12px;
    }

    .journal-name {
      color: #2c3e50;
      font-weight: 500;
      flex: 1;
    }

    .journal-count {
      color: #667eea;
      font-weight: 600;
      padding: 2px 8px;
      background: rgba(102, 126, 234, 0.1);
      border-radius: 12px;
    }

    /* æ“ä½œæŒ‰é’® */
    .detail-actions {
      display: flex;
      gap: 8px;
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid rgba(102, 126, 234, 0.1);
    }

    .detail-actions .btn {
      flex: 1;
    }

    .author-view-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
      padding: 12px 16px;
      background: var(--card-bg);
      border-radius: 10px;
      box-shadow: var(--shadow);
    }

    .author-view-back {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      background: var(--accent);
      color: #fff;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s ease;
      border: none;
    }

    .author-view-back:hover {
      background: #1b6cef;
    }

    .author-view-back:active {
      transform: scale(0.97);
    }

    .author-view-info {
      flex: 1;
      font-size: 16px;
      font-weight: 600;
      color: #2c3e50;
    }

    /* ========== æœŸåˆŠè§†å›¾æ ·å¼ ========== */
    .journal-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      gap: 20px;
      margin-top: 16px;
    }

    .journal-card {
      background: linear-gradient(135deg, #f8f9ff 0%, #ffffff 100%);
      border-radius: 16px;
      padding: 24px;
      box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
      cursor: pointer;
      transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      border: 2px solid transparent;
      display: flex;
      flex-direction: column;
      gap: 16px;
      position: relative;
      overflow: hidden;
    }

    /* æœŸåˆŠå¡ç‰‡é¡¶éƒ¨è£…é¥°æ¡ (æ ¹æ®åˆ†çº§æ˜¾ç¤ºä¸åŒé¢œè‰²) */
    .journal-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .journal-card.tier-t1::before {
      background: linear-gradient(90deg, #FFD700 0%, #FFA500 100%);  /* é‡‘è‰² */
    }

    .journal-card.tier-t2::before {
      background: linear-gradient(90deg, #E8E8E8 0%, #A8A8A8 100%);  /* é“¶è‰² */
    }

    .journal-card.tier-t3::before {
      background: linear-gradient(90deg, #CD7F32 0%, #8B4513 100%);  /* é“œè‰² */
    }

    .journal-card.tier-unranked::before {
      background: linear-gradient(90deg, #B0B0B0 0%, #808080 100%);  /* ç°è‰² */
    }

    .journal-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 24px rgba(102, 126, 234, 0.2);
      border-color: rgba(102, 126, 234, 0.3);
    }

    .journal-card:hover::before {
      opacity: 1;
    }

    .journal-card.selected {
      border-color: #667eea;
      box-shadow: 0 12px 28px rgba(102, 126, 234, 0.3);
      background: linear-gradient(135deg, #f0f3ff 0%, #ffffff 100%);
    }

    .journal-card.expanded {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 90%;
      max-width: 900px;
      max-height: 85vh;
      overflow-y: auto;
      overflow-x: hidden;
      z-index: 150;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
      animation: journalCardExpand 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      -webkit-overflow-scrolling: touch;
    }

    @keyframes journalCardExpand {
      from {
        transform: translate(-50%, -50%) scale(0.9);
        opacity: 0;
      }
      to {
        transform: translate(-50%, -50%) scale(1);
        opacity: 1;
      }
    }

    /* æœŸåˆŠå¡ç‰‡å¤´éƒ¨ */
    .journal-card-header {
      display: flex;
      align-items: flex-start;
      justify-content: space-between;
      gap: 16px;
    }

    /* å±•å¼€çŠ¶æ€ä¸‹ä¸ºå…³é—­æŒ‰é’®ç•™å‡ºç©ºé—´ */
    .journal-card.expanded .journal-card-header {
      padding-right: 48px;  /* å…³é—­æŒ‰é’®å®½åº¦(32px) + é—´è·(16px) */
    }

    .journal-info-main {
      flex: 1;
      min-width: 0;
    }

    .journal-name {
      font-size: 17px;
      font-weight: 700;
      color: #2c3e50;
      margin-bottom: 8px;
      line-height: 1.4;
      word-break: break-word;
    }

    /* æœŸåˆŠåˆ†çº§å¾½ç«  */
    .journal-tier-badge {
      display: inline-flex;
      align-items: center;
      gap: 4px;
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 12px;
      font-weight: 700;
      color: #fff;
      margin-bottom: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }

    .journal-tier-badge.tier-t1 {
      background: linear-gradient(135deg, #FFD700, #FFA500);
    }

    .journal-tier-badge.tier-t2 {
      background: linear-gradient(135deg, #E8E8E8, #A8A8A8);
      color: #2c3e50;
    }

    .journal-tier-badge.tier-t3 {
      background: linear-gradient(135deg, #CD7F32, #8B4513);
    }

    .journal-tier-badge.tier-unranked {
      background: linear-gradient(135deg, #B0B0B0, #808080);
    }

    /* è¯„åˆ†åŒºåŸŸ */
    .journal-scores {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 6px;
      min-width: 100px;
    }

    .journal-final-score {
      font-size: 28px;
      font-weight: 700;
      background: linear-gradient(135deg, #667eea, #764ba2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .journal-score-label {
      font-size: 11px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* æœŸåˆŠæ‰“æ˜Ÿç»„ä»¶ */
    .journal-star-rating {
      display: flex;
      gap: 3px;
      margin-top: 4px;
    }

    .star-icon {
      font-size: 16px;
      cursor: pointer;
      transition: all 0.2s ease;
      color: #d6dbe8;
      user-select: none;
    }

    .star-icon.filled {
      color: #fbbf24;
    }

    .star-icon:hover {
      transform: scale(1.2);
      color: #fbbf24;
    }

    .star-icon:active {
      transform: scale(0.9);
    }

    /* ç»Ÿè®¡å¡ç‰‡ */
    .journal-stats {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 12px;
      padding: 16px;
      background: rgba(102, 126, 234, 0.05);
      border-radius: 12px;
    }

    .journal-stat-item {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 4px;
      padding: 8px;
    }

    .journal-stat-value {
      font-size: 20px;
      font-weight: 700;
      color: #667eea;
    }

    .journal-stat-label {
      font-size: 11px;
      color: var(--muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
      text-align: center;
    }

    /* å…³é—­æŒ‰é’® */
    .journal-close-btn {
      position: absolute;
      top: 16px;
      right: 16px;
      width: 32px;
      height: 32px;
      border-radius: 50%
;
      background: rgba(0, 0, 0, 0.1);
      display: none;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      font-size: 20px;
      transition: all 0.2s ease;
      z-index: 1;
    }

    .journal-card.expanded .journal-close-btn {
      display: flex;
    }

    .journal-close-btn:hover {
      background: rgba(0, 0, 0, 0.2);
      transform: scale(1.1);
    }

    .journal-close-btn:active {
      transform: scale(0.95);
    }

    /* æœŸåˆŠè¯¦æƒ…åŒºåŸŸ */
    .journal-card-details {
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .journal-card.expanded .journal-card-details {
      max-height: none;
      overflow: visible;
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid rgba(102, 126, 234, 0.2);
    }

    /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
    .journal-card.expanded::-webkit-scrollbar {
      width: 8px;
    }

    .journal-card.expanded::-webkit-scrollbar-track {
      background: rgba(0, 0, 0, 0.05);
      border-radius: 4px;
    }

    .journal-card.expanded::-webkit-scrollbar-thumb {
      background: rgba(102, 126, 234, 0.3);
      border-radius: 4px;
    }

    .journal-card.expanded::-webkit-scrollbar-thumb:hover {
      background: rgba(102, 126, 234, 0.5);
    }

    /* ä»£è¡¨ä½œåˆ—è¡¨ */
    .journal-rep-papers {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .journal-rep-paper-item {
      padding: 12px 14px;
      background: rgba(102, 126, 234, 0.03);
      border-radius: 8px;
      border-left: 3px solid #667eea;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .journal-rep-paper-item:hover {
      background: rgba(102, 126, 234, 0.08);
      transform: translateX(4px);
    }

    .journal-rep-paper-title {
      font-size: 14px;
      font-weight: 500;
      color: #2c3e50;
      margin-bottom: 6px;
      line-height: 1.4;
    }

    .journal-rep-paper-meta {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 11px;
      color: var(--muted);
    }

    /* å¹´ä»½åˆ†å¸ƒå›¾è¡¨ */
    .journal-trend-chart {
      display: flex;
      flex-direction: column;
      gap: 8px;
      padding: 12px;
      background: rgba(102, 126, 234, 0.03);
      border-radius: 8px;
    }

    .journal-trend-bar {
      display: flex;
      align-items: center;
      gap: 10px;
      font-size: 12px;
    }

    .journal-trend-year {
      width: 50px;
      color: var(--muted);
      font-weight: 600;
    }

    .journal-trend-bar-container {
      flex: 1;
      height: 20px;
      background: rgba(102, 126, 234, 0.1);
      border-radius: 4px;
      overflow: hidden;
    }

    .journal-trend-bar-fill {
      height: 100%;
      background: linear-gradient(90deg, #667eea, #764ba2);
      border-radius: 4px;
      transition: width 0.5s ease;
    }

    .journal-trend-count {
      width: 50px;
      text-align: right;
      color: #667eea;
      font-weight: 600;
    }

    /* æ“ä½œæŒ‰é’® */
    .journal-actions {
      display: flex;
      gap: 8px;
      margin-top: 16px;
      padding-top: 16px;
      border-top: 1px solid rgba(102, 126, 234, 0.1);
    }

    .journal-actions .btn {
      flex: 1;
    }

    /* è¿”å›å¤´éƒ¨ */
    .journal-view-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 16px;
      padding: 12px 16px;
      background: var(--card-bg);
      border-radius: 10px;
      box-shadow: var(--shadow);
    }

    .journal-view-back {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px 14px;
      background: var(--accent);
      color: #fff;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      transition: all 0.2s ease;
      border: none;
    }

    .journal-view-back:hover {
      background: #1b6cef;
    }

    .journal-view-back:active {
      transform: scale(0.97);
    }

    .journal-view-info {
      flex: 1;
      font-size: 16px;
      font-weight: 600;
      color: #2c3e50;
    }

    /* ========== å“åº”å¼ ========== */
    @media (max-width: 1024px) {
      .literature-grid {
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      }

      .literature-card.expanded {
        grid-column: auto;
      }

      .author-grid {
        grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
      }
    }

    @media (max-width: 768px) {
      .topbar {
        padding: 12px 14px;
      }

      .topbar-main {
        flex-direction: column;
        align-items: stretch;
        min-width: 100%;
        gap: 10px;
      }

      .literature-grid {
        grid-template-columns: 1fr;
        gap: 12px;
      }

      .container {
        padding: 12px 14px 80px;
      }
    }

    /* ========== é«˜äº®æ ·å¼ ========== */
    mark.highlight {
      background: rgba(255, 230, 120, 0.9);
      color: #111;
      padding: 0 2px;
      border-radius: 2px;
    }
  </style>
</head>
<body>
  <!-- å›ºå®šé¡¶æ  -->
  <div class="topbar">
    <div class="topbar-main">
      <div class="search-input-wrap">
        <input id="searchInput" class="search-input" placeholder="æœç´¢æ–‡çŒ®ï¼šæ ‡é¢˜ã€ä½œè€…ã€å…³é”®è¯ã€å¹´ä»½..." autocomplete="off" />
        <div id="searchCount" class="search-count">0 ç¯‡æ–‡çŒ®</div>
      </div>
    </div>
    <div class="topbar-actions">
      <button id="toggleFiltersBtn" class="btn ghost" type="button">ç­›é€‰</button>
      <button id="refreshBtn" class="btn" type="button">ğŸ”„ åˆ·æ–°</button>
      <button id="clearBtn" class="btn" type="button">æ¸…ç©º</button>
    </div>
  </div>

  <!-- Tab å¯¼èˆªæ  -->
  <div class="view-tabs" id="viewTabs">
    <div class="tab active" data-view="all">ğŸ“š å…¨éƒ¨ (0)</div>
    <div class="tab" data-view="pinned">â­ æ˜Ÿæ ‡ (0)</div>
    <div class="tab disabled" data-view="author">ğŸ‘¤ ä½œè€…</div>
    <div class="tab disabled" data-view="journal">ğŸ“– æœŸåˆŠ</div>
  </div>

  <!-- ç­›é€‰é¢æ¿ -->
  <div class="filters-panel" id="filtersPanel">
    <!-- æ–‡çŒ®ç±»å‹ç­›é€‰ -->
    <div class="filter-section">
      <div class="filter-label">æ–‡çŒ®ç±»å‹</div>
      <div class="pill-row" id="typeFilters">
        <!-- åŠ¨æ€æ¸²æŸ“ -->
      </div>
    </div>

    <!-- å¹´ä»½èŒƒå›´ -->
    <div class="filter-section">
      <div class="filter-label">å¹´ä»½èŒƒå›´</div>
      <div class="year-range-slider">
        <span class="year-label" id="yearStartLabel">2000</span>
        <input type="range" id="yearStartRange" min="1990" max="2030" value="2000" />
        <span style="color: #999;">è‡³</span>
        <input type="range" id="yearEndRange" min="1990" max="2030" value="2030" />
        <span class="year-label" id="yearEndLabel">2030</span>
      </div>
    </div>

    <!-- æœŸåˆŠ/ä¼šè®®ç­›é€‰ -->
    <div class="filter-section">
      <div class="filter-label">æœŸåˆŠ/ä¼šè®®</div>
      <div class="pill-row" id="venueFilters">
        <!-- åŠ¨æ€æ¸²æŸ“ -->
      </div>
    </div>
  </div>

  <!-- ä¸»å†…å®¹åŒº -->
  <div class="main-layout" id="mainLayout">
    <div class="container">
      <div class="literature-grid" id="literatureGrid">
        <!-- åŠ¨æ€æ¸²æŸ“æ–‡çŒ®å¡ç‰‡ -->
      </div>

      <!-- åŠ è½½æ›´å¤š -->
      <div class="load-more-container" id="loadMoreContainer">
        <button class="btn primary" id="loadMoreBtn">åŠ è½½æ›´å¤š</button>
      </div>
    </div>
  </div>

  <!-- Toast æç¤º -->
  <div class="toast" id="toast"></div>

  <!-- èƒŒæ™¯æ¨¡ç³Šé®ç½© -->
  <div class="backdrop-blur" id="backdropBlur"></div>

  <script>
    // ==================== æ•°æ®æ¨¡å‹å’ŒçŠ¶æ€ç®¡ç† ====================

    const state = {
      // å…¨éƒ¨æ–‡çŒ®æ•°æ®
      literatures: [],
      // ç­›é€‰åçš„æ–‡çŒ®
      filteredLiteratures: [],
      // æ˜¾ç¤ºçš„æ–‡çŒ®ï¼ˆåˆ†é¡µï¼‰
      displayedLiteratures: [],
      // å½“å‰é€‰ä¸­çš„æ–‡çŒ®ID
      selectedId: null,
      // å½“å‰å±•å¼€çš„æ–‡çŒ®IDï¼ˆæ˜¾ç¤ºè¯¦æƒ…ï¼‰
      expandedId: null,
      // æœç´¢å…³é”®è¯
      searchQuery: '',
      // ç­›é€‰å™¨çŠ¶æ€
      filters: {
        activeType: 'all',
        yearStart: 2000,
        yearEnd: 2030,
        activeVenue: 'all'
      },
      // åˆ†é¡µçŠ¶æ€
      pagination: {
        currentPage: 1,
        pageSize: 50,
        hasMore: false
      },
      // å¯ç”¨çš„æœŸåˆŠ/ä¼šè®®åˆ—è¡¨
      availableVenues: new Set(),
      // æ˜Ÿæ ‡æ–‡çŒ®IDé›†åˆ
      pinnedLiteratures: new Set(),
      // å½“å‰è§†å›¾: 'all' | 'pinned' | 'author' | 'journal'
      currentView: 'all',
      // ä½œè€…æ•°æ® Map: authorName -> { count, years, citations, literatures }
      authors: new Map(),
      // å½“å‰é€‰ä¸­çš„ä½œè€…
      selectedAuthor: null,
      // å½“å‰å±•å¼€çš„ä½œè€…ï¼ˆæ‚¬æµ®æ˜¾ç¤ºï¼‰
      expandedAuthor: null,
      // æœŸåˆŠæ•°æ® Map: journalName -> { name, tier, autoScore, manualStars, finalScore, count, literatures, representativePapers }
      journals: new Map(),
      // ç”¨æˆ·å¯¹æœŸåˆŠçš„æ‰“æ˜Ÿè¯„åˆ†
      journalStarRatings: new Map(),
      // å½“å‰é€‰ä¸­çš„æœŸåˆŠ
      selectedJournal: null,
      // å½“å‰å±•å¼€çš„æœŸåˆŠï¼ˆæ‚¬æµ®æ˜¾ç¤ºï¼‰
      expandedJournal: null
    };

    // DOM å…ƒç´ å¼•ç”¨
    const dom = {
      searchInput: document.getElementById('searchInput'),
      searchCount: document.getElementById('searchCount'),
      toggleFiltersBtn: document.getElementById('toggleFiltersBtn'),
      refreshBtn: document.getElementById('refreshBtn'),
      clearBtn: document.getElementById('clearBtn'),
      viewTabs: document.getElementById('viewTabs'),
      filtersPanel: document.getElementById('filtersPanel'),
      mainLayout: document.getElementById('mainLayout'),
      typeFilters: document.getElementById('typeFilters'),
      yearStartRange: document.getElementById('yearStartRange'),
      yearEndRange: document.getElementById('yearEndRange'),
      yearStartLabel: document.getElementById('yearStartLabel'),
      yearEndLabel: document.getElementById('yearEndLabel'),
      venueFilters: document.getElementById('venueFilters'),
      literatureGrid: document.getElementById('literatureGrid'),
      loadMoreContainer: document.getElementById('loadMoreContainer'),
      loadMoreBtn: document.getElementById('loadMoreBtn'),
      toast: document.getElementById('toast'),
      backdropBlur: document.getElementById('backdropBlur')
    };

    // ==================== Bridge é€šä¿¡æ¥å£ ====================

    window.Bridge = {
      /**
       * åŠ è½½æ–‡çŒ®æ•°æ® (Native â†’ JS)
       * @param {Object} data - æ–‡çŒ®æ•°æ®å¯¹è±¡
       * @param {Array} data.literatures - æ–‡çŒ®æ•°ç»„
       */
      loadLiteratures: function(data) {
        console.log('Bridge.loadLiteratures è¢«è°ƒç”¨', data);

        if (data && Array.isArray(data.literatures)) {
          state.literatures = data.literatures;
          extractVenues();
          applyFilters();
          renderFilters();
          showToast(`å·²åŠ è½½ ${data.literatures.length} ç¯‡æ–‡çŒ®`);
        }
      },

      /**
       * åˆ·æ–°æ•°æ® (JS â†’ Native)
       */
      refreshData: function() {
        console.log('Bridge.refreshData è¢«è°ƒç”¨');
        postBridge('refreshLiteratures');
      },

      /**
       * é€šçŸ¥å°±ç»ª (JS â†’ Native)
       */
      notifyReady: function() {
        console.log('Bridge.notifyReady è¢«è°ƒç”¨');
        postBridge('htmlReady');
      }
    };

    // ==================== å·¥å…·å‡½æ•° ====================

    /**
     * å‘ Native å‘é€æ¶ˆæ¯
     */
    function postBridge(action, params = {}) {
      try {
        const url = `mnliterature://${action}?${buildQueryString(params)}`;
        window.location.href = url;
        return true;
      } catch (error) {
        console.warn('postBridge å¤±è´¥', error);
        return false;
      }
    }

    /**
     * æ„å»ºæŸ¥è¯¢å­—ç¬¦ä¸²
     */
    function buildQueryString(params) {
      return Object.keys(params)
        .map(key => {
          const value = typeof params[key] === 'object'
            ? JSON.stringify(params[key])
            : params[key];
          return `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;
        })
        .join('&');
    }

    /**
     * æ˜¾ç¤º Toast æç¤º
     */
    function showToast(message, duration = 1600) {
      dom.toast.textContent = message;
      dom.toast.classList.add('show');

      clearTimeout(showToast.timer);
      showToast.timer = setTimeout(() => {
        dom.toast.classList.remove('show');
      }, duration);
    }

    /**
     * é˜²æŠ–å‡½æ•°
     */
    function debounce(fn, wait) {
      let timer = null;
      return function(...args) {
        clearTimeout(timer);
        timer = setTimeout(() => fn.apply(this, args), wait);
      };
    }

    /**
     * HTML è½¬ä¹‰
     */
    function escapeHtml(text) {
      if (!text) return '';
      return text
        .replace(/&/g, '&amp;')
        .replace(/</g, '&lt;')
        .replace(/>/g, '&gt;');
    }

    /**
     * é«˜äº®å…³é”®è¯
     */
    function highlightText(text, query) {
      if (!text || !query) return escapeHtml(text);

      const keywords = query.trim().split(/\s+/);
      let result = escapeHtml(text);

      keywords.forEach(keyword => {
        if (!keyword) return;
        const regex = new RegExp(`(${escapeRegExp(keyword)})`, 'gi');
        result = result.replace(regex, '<mark class="highlight">$1</mark>');
      });

      return result;
    }

    function escapeRegExp(string) {
      return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
    }

    /**
     * å°†å­—ç¬¦ä¸²è½¬æ¢ä¸º Title Case
     */
    String.prototype.toTitleCase = function () {
      'use strict'
      let smallWords = /^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|v.?|vs.?|via)$/i;
      let alphanumericPattern = /([A-Za-z0-9\u00C0-\u00FF])/;
      /* note there is a capturing group, so the separators will also be included in the returned list */
      let wordSeparators = /([ :â€“â€”-])/;
      let lowerBar = /_/g;
      /* regular expression: remove the space character, punctuation (.,;:!?),
         dash and lower bar at both ends of the string */
      let trimBeginEndPattern = /^[\s.,;:!?_\-]*([a-zA-Z0-9].*[a-zA-Z0-9])[\s.,;:!?_\-]*$/g;
      let romanNumberPattern = /^(I|II|III|IV|V|VI|VII|VIII|IX|X)$/i;

      return this.toLowerCase().replace(trimBeginEndPattern,"$1")
        .replace(lowerBar, " ")
        .split(wordSeparators)
        .map(function (current, index, array) {
          if (
            /* Check for small words */
            current.search(smallWords) > -1 &&
            /* Skip first and last word */
            index !== 0 &&
            index !== array.length - 1 &&
            /* cope with the situation such as: 1. the conjugation operator */
            array.slice(0,index-1).join('').search(/[a-zA-Z]/) > -1 &&
            /* Ignore title end and subtitle start */
            array[index - 3] !== ':' &&
            array[index + 1] !== ':' &&
            /* Ignore small words that start a hyphenated phrase */
            (array[index + 1] !== '-' ||
              (array[index - 1] === '-' && array[index + 1] === '-'))
          ) {
            return current.toLowerCase()
          }

          /* Uppercase roman numbers */
          if (current.search(romanNumberPattern) > -1) {
            return current.toUpperCase();
          }

          /* Ignore intentional capitalization */
          if (current.substring(1).search(/[A-Z]|\../) > -1) {
            return current;
          }

          /* Ignore URLs */
          if (array[index + 1] === ':' && array[index + 2] !== '') {
            return current;
          }

          /* Capitalize the first letter */
          return current.replace(alphanumericPattern, function (match) {
            return match.toUpperCase();
          })
        })
        .join('') // convert the list into a string
    }

    /**
     * é«˜äº®æ–‡æœ¬å¹¶åº”ç”¨ Title Caseï¼ˆç”¨äºæœŸåˆŠåç§°ï¼‰
     */
    function highlightJournalName(name, query) {
      if (!name) return '';
      const titleCased = name.toTitleCase();
      return highlightText(titleCased, query);
    }

    // ==================== æœŸåˆŠåˆ†çº§æ•°æ® ====================

    /**
     * æ•°å­¦é¢†åŸŸé«˜è´¨é‡ç§‘æŠ€æœŸåˆŠåˆ†çº§ç›®å½• (2024å¹´ç‰ˆ)
     * æ•°æ®æ¥æº: æ•°å­¦é¢†åŸŸé«˜è´¨é‡ç§‘æŠ€æœŸåˆŠåˆ†çº§ç›®å½• ï¼ˆ2024 å¹´ç‰ˆï¼‰
     */
    const mathJournalTiers = {
      // T1: 26 ç§æœŸåˆŠ
      "ACTA MATHEMATICA": "T1",
      "ACTA MATHEMATICA SCIENTIA": "T1",
      "ACTA MATHEMATICA SINICA-ENGLISH SERIES": "T1",
      "ADVANCES IN MATHEMATICS": "T1",
      "AMERICAN JOURNAL OF MATHEMATICS": "T1",
      "ANNALES SCIENTIFIQUES DE L ECOLE NORMALE SUPERIEURE": "T1",
      "ANNALS OF MATHEMATICS": "T1",
      "ASTERISQUE": "T1",
      "CAMBRIDGE JOURNAL OF MATHEMATICS": "T1",
      "COMMUNICATIONS IN MATHEMATICAL PHYSICS": "T1",
      "COMMUNICATIONS ON PURE AND APPLIED MATHEMATICS": "T1",
      "COMPOSITIO MATHEMATICA": "T1",
      "DUKE MATHEMATICAL JOURNAL": "T1",
      "GEOMETRIC AND FUNCTIONAL ANALYSIS": "T1",
      "INVENTIONES MATHEMATICAE": "T1",
      "IZVESTIYA MATHEMATICS": "T1",
      "JOURNAL DE MATHEMATIQUES PURES ET APPLIQUEES": "T1",
      "JOURNAL FUR DIE REINE UND ANGEWANDTE MATHEMATIK": "T1",
      "JOURNAL OF THE AMERICAN MATHEMATICAL SOCIETY": "T1",
      "JOURNAL OF THE EUROPEAN MATHEMATICAL SOCIETY": "T1",
      "MATHEMATISCHE ANNALEN": "T1",
      "MEMOIRS OF THE AMERICAN MATHEMATICAL SOCIETY": "T1",
      "PEKING MATHEMATICAL JOURNAL": "T1",
      "PROCEEDINGS OF THE LONDON MATHEMATICAL SOCIETY": "T1",
      "PUBLICATIONS MATHEMATIQUES DE L IHES": "T1",
      "SCIENCE CHINA-MATHEMATICS": "T1",

      // T2: 78 ç§æœŸåˆŠ
      "ACTA ARITHMETICA": "T2",
      "ALGEBRA & NUMBER THEORY": "T2",
      "ALGEBRAIC AND GEOMETRIC TOPOLOGY": "T2",
      "ALGEBRAIC GEOMETRY": "T2",
      "ALGEBRAS AND REPRESENTATION THEORY": "T2",
      "ANALYSIS & PDE": "T2",
      "ANALYSIS IN THEORY AND APPLICATIONS": "T2",
      "ANNALES DE L INSTITUT FOURIER": "T2",
      "ANNALES HENRI POINCARE": "T2",
      "ANNALI DELLA SCUOLA NORMALE SUPERIORE DI PISA-CLASSE DI SCIENZE": "T2",
      "ANNALS OF PDE": "T2",
      "ANNALS OF PURE AND APPLIED LOGIC": "T2",
      "BULLETIN DES SCIENCES MATHEMATIQUES": "T2",
      "BULLETIN OF THE AMERICAN MATHEMATICAL SOCIETY": "T2",
      "BULLETIN OF THE LONDON MATHEMATICAL SOCIETY": "T2",
      "CALCULUS OF VARIATIONS AND PARTIAL DIFFERENTIAL EQUATIONS": "T2",
      "CANADIAN JOURNAL OF MATHEMATICS-JOURNAL CANADIEN DE MATHEMATIQUES": "T2",
      "CHINESE ANNALS OF MATHEMATICS SERIES B": "T2",
      "COMBINATORICA": "T2",
      "COMBINATORICS PROBABILITY & COMPUTING": "T2",
      "COMMENTARII MATHEMATICI HELVETICI": "T2",
      "COMMUNICATIONS IN ANALYSIS AND GEOMETRY": "T2",
      "COMMUNICATIONS IN PARTIAL DIFFERENTIAL EQUATIONS": "T2",
      "COMMUNICATIONS ON PURE AND APPLIED ANALYSIS": "T2",
      "DISCRETE AND CONTINUOUS DYNAMICAL SYSTEMS": "T2",
      "DISCRETE MATHEMATICS": "T2",
      "ERGODIC THEORY AND DYNAMICAL SYSTEMS": "T2",
      "EUROPEAN JOURNAL OF COMBINATORICS": "T2",
      "FORUM MATHEMATICUM": "T2",
      "FORUM OF MATHEMATICS PI": "T2",
      "FRONTIERS OF MATHEMATICS": "T2",
      "FUNDAMENTA MATHEMATICAE": "T2",
      "GEOMETRY & TOPOLOGY": "T2",
      "INDIANA UNIVERSITY MATHEMATICS JOURNAL": "T2",
      "INTERNATIONAL MATHEMATICS RESEARCH NOTICES": "T2",
      "ISRAEL JOURNAL OF MATHEMATICS": "T2",
      "JOURNAL D ANALYSE MATHEMATIQUE": "T2",
      "JOURNAL OF ALGEBRA": "T2",
      "JOURNAL OF ALGEBRAIC GEOMETRY": "T2",
      "JOURNAL OF COMBINATORIAL THEORY SERIES A": "T2",
      "JOURNAL OF COMBINATORIAL THEORY SERIES B": "T2",
      "JOURNAL OF DIFFERENTIAL EQUATIONS": "T2",
      "JOURNAL OF DIFFERENTIAL GEOMETRY": "T2",
      "JOURNAL OF FUNCTIONAL ANALYSIS": "T2",
      "JOURNAL OF GEOMETRIC ANALYSIS": "T2",
      "JOURNAL OF GEOMETRY AND PHYSICS": "T2",
      "JOURNAL OF GRAPH THEORY": "T2",
      "JOURNAL OF MATHEMATICAL LOGIC": "T2",
      "JOURNAL OF MATHEMATICAL PHYSICS": "T2",
      "JOURNAL OF MATHEMATICAL STUDY": "T2",
      "JOURNAL OF NONCOMMUTATIVE GEOMETRY": "T2",
      "JOURNAL OF NUMBER THEORY": "T2",
      "JOURNAL OF PARTIAL DIFFERENTIAL EQUATIONS": "T2",
      "JOURNAL OF PURE AND APPLIED ALGEBRA": "T2",
      "JOURNAL OF SPECTRAL THEORY": "T2",
      "JOURNAL OF SYMBOLIC LOGIC": "T2",
      "JOURNAL OF SYMPLECTIC GEOMETRY": "T2",
      "JOURNAL OF THE LONDON MATHEMATICAL SOCIETY-SECOND SERIES": "T2",
      "JOURNAL OF TOPOLOGY": "T2",
      "LETTERS IN MATHEMATICAL PHYSICS": "T2",
      "MATHEMATICAL PROCEEDINGS OF THE CAMBRIDGE PHILOSOPHICAL SOCIETY": "T2",
      "MATHEMATICAL RESEARCH LETTERS": "T2",
      "MATHEMATISCHE ZEITSCHRIFT": "T2",
      "MEMOIRES DE LA SOCIETE MATHEMATIQUE DE FRANCE": "T2",
      "PACIFIC JOURNAL OF MATHEMATICS": "T2",
      "POTENTIAL ANALYSIS": "T2",
      "PROCEEDINGS OF THE AMERICAN MATHEMATICAL SOCIETY": "T2",
      "PROCEEDINGS OF THE ROYAL SOCIETY OF EDINBURGH SECTION A-MATHEMATICS": "T2",
      "PUBLICATIONS OF THE RESEARCH INSTITUTE FOR MATHEMATICAL SCIENCES": "T2",
      "REPRESENTATION THEORY": "T2",
      "REVISTA MATEMATICA IBEROAMERICANA": "T2",
      "RUSSIAN MATHEMATICAL SURVEYS": "T2",
      "SBORNIK MATHEMATICS": "T2",
      "SELECTA MATHEMATICA-NEW SERIES": "T2",
      "SEMIGROUP FORUM": "T2",
      "STUDIA MATHEMATICA": "T2",
      "TOPOLOGY AND ITS APPLICATIONS": "T2",
      "TRANSACTIONS OF THE AMERICAN MATHEMATICAL SOCIETY": "T2",

      // T3: 94 ç§æœŸåˆŠ (åªåˆ—å‡ºéƒ¨åˆ†,å®Œæ•´åˆ—è¡¨è§æ–‡æ¡£)
      "ADVANCED NONLINEAR STUDIES": "T3",
      "ADVANCES IN CALCULUS OF VARIATIONS": "T3",
      "ADVANCES IN GEOMETRY": "T3",
      "ALGEBRA COLLOQUIUM": "T3",
      "ALGEBRA UNIVERSALIS": "T3",
      "ANALYSIS AND MATHEMATICAL PHYSICS": "T3",
      "ANNALI DI MATEMATICA PURA ED APPLICATA": "T3",
      "ANNALS OF COMBINATORICS": "T3",
      "ANNALS OF GLOBAL ANALYSIS AND GEOMETRY": "T3",
      "APPLIED CATEGORICAL STRUCTURES": "T3",
      "ARCHIVE FOR MATHEMATICAL LOGIC": "T3",
      "ASIAN JOURNAL OF MATHEMATICS": "T3",
      "BANACH JOURNAL OF MATHEMATICAL ANALYSIS": "T3",
      "BULLETIN DE LA SOCIETE MATHEMATIQUE DE FRANCE": "T3",
      "BULLETIN OF SYMBOLIC LOGIC": "T3",
      "BULLETIN OF THE AUSTRALIAN MATHEMATICAL SOCIETY": "T3",
      "CANADIAN MATHEMATICAL BULLETIN-BULLETIN CANADIEN DE MATHEMATIQUES": "T3",
      "COLLOQUIUM MATHEMATICUM": "T3",
      "COMMUNICATIONS IN ALGEBRA": "T3",
      "COMMUNICATIONS IN CONTEMPORARY MATHEMATICS": "T3",
      "COMMUNICATIONS IN MATHEMATICAL RESEARCH": "T3",
      "COMMUNICATIONS OF THE AMERICAN MATHEMATICAL SOCIETY": "T3",
      "COMPTES RENDUS MATHEMATIQUE": "T3",
      "DIFFERENTIAL AND INTEGRAL EQUATIONS": "T3",
      "DIFFERENTIAL GEOMETRY AND ITS APPLICATIONS": "T3",
      "FINITE FIELDS AND THEIR APPLICATIONS": "T3",
      "FIXED POINT THEORY": "T3",
      "FORUM OF MATHEMATICS SIGMA": "T3",
      "GEOMETRIAE DEDICATA": "T3",
      "GRAPHS AND COMBINATORICS": "T3",
      "HISTORIA MATHEMATICA": "T3",
      "HOUSTON JOURNAL OF MATHEMATICS": "T3",
      "INTEGRAL EQUATIONS AND OPERATOR THEORY": "T3",
      "INTEGRAL TRANSFORMS AND SPECIAL FUNCTIONS": "T3",
      "INTERNATIONAL JOURNAL OF MATHEMATICS": "T3",
      "JOURNAL OF ALGEBRA AND ITS APPLICATIONS": "T3",
      "JOURNAL OF ALGEBRAIC COMBINATORICS": "T3",
      "JOURNAL OF APPROXIMATION THEORY": "T3",
      "JOURNAL OF COMBINATORIAL ALGEBRA": "T3",
      "JOURNAL OF CONVEX ANALYSIS": "T3",
      "JOURNAL OF DYNAMICS AND DIFFERENTIAL EQUATIONS": "T3",
      "JOURNAL OF EVOLUTION EQUATIONS": "T3",
      "JOURNAL OF FIXED POINT THEORY AND APPLICATIONS": "T3",
      "JOURNAL OF GROUP THEORY": "T3",
      "JOURNAL OF INTEGRAL EQUATIONS AND APPLICATIONS": "T3",
      "JOURNAL OF KNOT THEORY AND ITS RAMIFICATIONS": "T3",
      "JOURNAL OF LIE THEORY": "T3",
      "JOURNAL OF MATHEMATICAL ANALYSIS AND APPLICATIONS": "T3",
      "JOURNAL OF MATHEMATICAL RESEARCH WITH APPLICATIONS": "T3",
      "JOURNAL OF OPERATOR THEORY": "T3",
      "JOURNAL OF THE AUSTRALIAN MATHEMATICAL SOCIETY": "T3",
      "JOURNAL OF THE INSTITUTE OF MATHEMATICS OF JUSSIEU": "T3",
      "JOURNAL OF THE KOREAN MATHEMATICAL SOCIETY": "T3",
      "JOURNAL OF THE MATHEMATICAL SOCIETY OF JAPAN": "T3",
      "JOURNAL OF TOPOLOGY AND ANALYSIS": "T3",
      "KYOTO JOURNAL OF MATHEMATICS": "T3",
      "LINEAR & MULTILINEAR ALGEBRA": "T3",
      "LINEAR ALGEBRA AND ITS APPLICATIONS": "T3",
      "LOGIC JOURNAL OF THE IGPL": "T3",
      "MANUSCRIPTA MATHEMATICA": "T3",
      "MATHEMATICAL LOGIC QUARTERLY": "T3",
      "MATHEMATIKA": "T3",
      "MATHEMATISCHE NACHRICHTEN": "T3",
      "MICHIGAN MATHEMATICAL JOURNAL": "T3",
      "MONATSHEFTE FUR MATHEMATIK": "T3",
      "MOSCOW MATHEMATICAL JOURNAL": "T3",
      "NOTRE DAME JOURNAL OF FORMAL LOGIC": "T3",
      "ORDER-A JOURNAL ON THE THEORY OF ORDERED SETS AND ITS APPLICATIONS": "T3",
      "PROCEEDINGS OF THE EDINBURGH MATHEMATICAL SOCIETY": "T3",
      "PROCEEDINGS OF THE STEKLOV INSTITUTE OF MATHEMATICS": "T3",
      "PUBLICATIONES MATHEMATICAE-DEBRECEN": "T3",
      "QUALITATIVE THEORY OF DYNAMICAL SYSTEMS": "T3",
      "QUARTERLY JOURNAL OF MATHEMATICS": "T3",
      "RAMANUJAN JOURNAL": "T3",
      "RESULTS IN MATHEMATICS": "T3",
      "ROCKY MOUNTAIN JOURNAL OF MATHEMATICS": "T3",
      "ST PETERSBURG MATHEMATICAL JOURNAL": "T3",
      "STATISTICAL THEORY AND RELATED FIELDS": "T3",
      "SYMMETRY INTEGRABILITY AND GEOMETRY-METHODS AND APPLICATIONS": "T3",
      "THEORY AND APPLICATIONS OF CATEGORIES": "T3",
      "TOKYO JOURNAL OF MATHEMATICS": "T3",
      "TOPOLOGICAL METHODS IN NONLINEAR ANALYSIS": "T3",
      "TRANSFORMATION GROUPS": "T3"
    };

    /**
     * è§„èŒƒåŒ–æœŸåˆŠåç§°ç”¨äºåŒ¹é…
     * @param {string} name - æœŸåˆŠåç§°
     * @returns {string} è§„èŒƒåŒ–åçš„åç§°
     */
    function normalizeJournalName(name) {
      if (!name) return '';
      return name
        .toUpperCase()
        .replace(/[^A-Z0-9\u4e00-\u9fa5]/g, ' ')  // ä¿ç•™ä¸­æ–‡
        .replace(/\s+/g, ' ')
        .trim();
    }

    /**
     * æŸ¥è¯¢æœŸåˆŠåˆ†çº§
     * @param {string} journalName - æœŸåˆŠåç§°
     * @returns {string|null} åˆ†çº§ (T1/T2/T3) æˆ– null
     */
    function getJournalTier(journalName) {
      if (!journalName) return null;

      const normalized = normalizeJournalName(journalName);

      // ç²¾ç¡®åŒ¹é…
      if (mathJournalTiers[journalName]) {
        return mathJournalTiers[journalName];
      }

      // è§„èŒƒåŒ–åŒ¹é…
      for (const [key, tier] of Object.entries(mathJournalTiers)) {
        if (normalizeJournalName(key) === normalized) {
          return tier;
        }
      }

      // æ¨¡ç³ŠåŒ¹é… (åŒ…å«å…³ç³»)
      for (const [key, tier] of Object.entries(mathJournalTiers)) {
        const normalizedKey = normalizeJournalName(key);
        if (normalizedKey.includes(normalized) || normalized.includes(normalizedKey)) {
          return tier;
        }
      }

      return null;
    }

    /**
     * å°†åˆ†çº§è½¬æ¢ä¸ºè‡ªåŠ¨è¯„åˆ†
     * @param {string|null} tier - åˆ†çº§
     * @returns {number} è¯„åˆ†
     */
    function tierToScore(tier) {
      const scoreMap = {
        'T1': 100,
        'T2': 80,
        'T3': 60
      };
      return scoreMap[tier] || 50;  // æœªåˆ†çº§é»˜è®¤50åˆ†
    }

    /**
     * è®¡ç®—æœŸåˆŠæœ€ç»ˆå¾—åˆ†
     * @param {number} autoScore - è‡ªåŠ¨è¯„åˆ† (0-100)
     * @param {number} manualStars - ç”¨æˆ·æ‰“æ˜Ÿ (0-5)
     * @returns {number} æœ€ç»ˆå¾—åˆ†
     */
    function calculateJournalScore(autoScore, manualStars) {
      if (manualStars > 0) {
        // ç”¨æˆ·æ‰“æ˜Ÿåï¼šç”¨æˆ·è¯„åˆ†å  60%ï¼Œè‡ªåŠ¨è¯„åˆ†å  40%
        const userScore = (manualStars / 5) * 100;
        return autoScore * 0.4 + userScore * 0.6;
      }
      // æ— ç”¨æˆ·è¯„åˆ†æ—¶ä½¿ç”¨è‡ªåŠ¨è¯„åˆ†
      return autoScore;
    }

    /**
     * å¹³æ»‘æ»šåŠ¨åˆ°æŒ‡å®šå¡ç‰‡
     */
    function scrollToCard(cardElement) {
      if (!cardElement) return;

      // ä½¿ç”¨ scrollIntoView å®ç°å¹³æ»‘æ»šåŠ¨
      cardElement.scrollIntoView({
        behavior: 'smooth',
        block: 'center',
        inline: 'nearest'
      });
    }

    /**
     * æ˜¾ç¤ºèƒŒæ™¯æ¨¡ç³Š
     */
    function showBackdrop() {
      dom.backdropBlur.classList.add('show');
      // ç¦æ­¢ body æ»šåŠ¨
      document.body.style.overflow = 'hidden';
    }

    /**
     * éšè—èƒŒæ™¯æ¨¡ç³Š
     */
    function hideBackdrop() {
      dom.backdropBlur.classList.remove('show');
      // æ¢å¤ body æ»šåŠ¨
      document.body.style.overflow = '';
    }

    /**
     * è·å–æ–‡çŒ®ç±»å‹é¢œè‰²
     */
    function getTypeColor(type) {
      const colorMap = {
        'article': 'var(--article-color)',
        'inproceedings': 'var(--conference-color)',
        'book': 'var(--book-color)',
        'phdthesis': 'var(--thesis-color)',
        'mastersthesis': 'var(--thesis-color)'
      };
      return colorMap[type] || 'var(--other-color)';
    }

    /**
     * è·å–æ–‡çŒ®ç±»å‹ä¸­æ–‡å
     */
    function getTypeName(type) {
      const nameMap = {
        'article': 'æœŸåˆŠè®ºæ–‡',
        'inproceedings': 'ä¼šè®®è®ºæ–‡',
        'book': 'ä¹¦ç±',
        'phdthesis': 'åšå£«è®ºæ–‡',
        'mastersthesis': 'ç¡•å£«è®ºæ–‡'
      };
      return nameMap[type] || 'å…¶ä»–';
    }

    // ==================== æ˜Ÿæ ‡åŠŸèƒ½ ====================

    /**
     * åˆ‡æ¢æ˜Ÿæ ‡çŠ¶æ€
     * @param {string} id - æ–‡çŒ®ID
     */
    function togglePin(id) {
      if (state.pinnedLiteratures.has(id)) {
        state.pinnedLiteratures.delete(id);
      } else {
        state.pinnedLiteratures.add(id);
      }
      savePinnedData();
      applyFilters();  // é‡æ–°æ’åº
    }

    /**
     * ä¿å­˜æ˜Ÿæ ‡æ•°æ®åˆ° localStorage
     */
    function savePinnedData() {
      const pinnedIds = Array.from(state.pinnedLiteratures);
      localStorage.setItem('mnliterature_pinned', JSON.stringify(pinnedIds));
    }

    /**
     * ä» localStorage åŠ è½½æ˜Ÿæ ‡æ•°æ®
     */
    function loadPinnedData() {
      try {
        const saved = localStorage.getItem('mnliterature_pinned');
        if (saved) {
          const pinnedIds = JSON.parse(saved);
          state.pinnedLiteratures = new Set(pinnedIds);
        }
      } catch (error) {
        console.error('åŠ è½½æ˜Ÿæ ‡æ•°æ®å¤±è´¥:', error);
        state.pinnedLiteratures = new Set();
      }
    }

    // ==================== æœŸåˆŠæ•°æ®æŒä¹…åŒ– ====================

    /**
     * ä¿å­˜æœŸåˆŠæ‰“æ˜Ÿæ•°æ®åˆ° localStorage
     */
    function saveJournalStarData() {
      try {
        const starData = {};
        state.journalStarRatings.forEach((stars, journalName) => {
          if (stars > 0) {
            starData[journalName] = stars;
          }
        });
        localStorage.setItem('mnliterature_journal_stars', JSON.stringify(starData));
      } catch (error) {
        console.error('ä¿å­˜æœŸåˆŠæ‰“æ˜Ÿæ•°æ®å¤±è´¥:', error);
      }
    }

    /**
     * ä» localStorage åŠ è½½æœŸåˆŠæ‰“æ˜Ÿæ•°æ®
     */
    function loadJournalStarData() {
      try {
        const saved = localStorage.getItem('mnliterature_journal_stars');
        if (saved) {
          const starData = JSON.parse(saved);
          state.journalStarRatings = new Map(Object.entries(starData));
        }
      } catch (error) {
        console.error('åŠ è½½æœŸåˆŠæ‰“æ˜Ÿæ•°æ®å¤±è´¥:', error);
        state.journalStarRatings = new Map();
      }
    }

    /**
     * åˆ‡æ¢æœŸåˆŠæ‰“æ˜Ÿ
     * @param {string} journalName - æœŸåˆŠåç§°
     * @param {number} stars - æ˜Ÿçº§ (0-5, 0è¡¨ç¤ºæ¸…é™¤)
     */
    function toggleJournalStar(journalName, stars) {
      if (stars > 0) {
        state.journalStarRatings.set(journalName, stars);
      } else {
        state.journalStarRatings.delete(journalName);
      }
      saveJournalStarData();

      // é‡æ–°è®¡ç®—è¯¥æœŸåˆŠçš„æœ€ç»ˆå¾—åˆ†
      const journal = state.journals.get(journalName);
      if (journal) {
        journal.manualStars = stars;
        journal.finalScore = calculateJournalScore(journal.autoScore, stars);
      }

      // é‡æ–°æ’åºå¹¶æ›´æ–°æ˜¾ç¤º
      applyFilters();
    }

    /**
     * å¯¹æ–‡çŒ®åˆ—è¡¨æ’åº(æ˜Ÿæ ‡ä¼˜å…ˆ)
     * @param {Array} literatures - æ–‡çŒ®åˆ—è¡¨
     * @returns {Array} æ’åºåçš„æ–‡çŒ®åˆ—è¡¨
     */
    function sortLiteratures(literatures) {
      return literatures.sort((a, b) => {
        const aPin = state.pinnedLiteratures.has(a.id) ? 1 : 0;
        const bPin = state.pinnedLiteratures.has(b.id) ? 1 : 0;

        // æ˜Ÿæ ‡çš„æ’åœ¨å‰é¢
        if (aPin !== bPin) {
          return bPin - aPin;
        }

        // åŒç­‰çº§æŒ‰å¹´ä»½é™åº
        return b.year - a.year;
      });
    }

    // ==================== æ•°æ®å¤„ç† ====================

    /**
     * æå–æ‰€æœ‰æœŸåˆŠ/ä¼šè®®
     */
    function extractVenues() {
      state.availableVenues.clear();
      state.literatures.forEach(lit => {
        if (lit.journal) {
          state.availableVenues.add(lit.journal);
        }
      });
    }

    /**
     * æå–æ‰€æœ‰ä½œè€…åŠç»Ÿè®¡ä¿¡æ¯
     */
    function extractAuthors() {
      state.authors.clear();

      // éå†ç­›é€‰åçš„æ–‡çŒ®
      state.filteredLiteratures.forEach(lit => {
        if (!Array.isArray(lit.authors) || lit.authors.length === 0) return;

        // å¤„ç†æ¯ä¸ªä½œè€…
        lit.authors.forEach(authorName => {
          if (!authorName || !authorName.trim()) return;

          const name = authorName.trim();

          if (!state.authors.has(name)) {
            // åˆå§‹åŒ–ä½œè€…æ•°æ®
            state.authors.set(name, {
              name: name,
              count: 0,
              years: [],
              literatures: [],
              yearDistribution: new Map(),  // å¹´ä»½åˆ†å¸ƒ
              keywords: new Map(),           // å…³é”®è¯ç»Ÿè®¡
              journals: new Map(),           // æœŸåˆŠç»Ÿè®¡
              coauthors: new Map()           // åˆä½œè€…ç»Ÿè®¡
            });
          }

          const author = state.authors.get(name);
          author.count++;
          author.years.push(lit.year);
          author.literatures.push(lit);

          // ç»Ÿè®¡å¹´ä»½åˆ†å¸ƒ
          const yearCount = author.yearDistribution.get(lit.year) || 0;
          author.yearDistribution.set(lit.year, yearCount + 1);

          // ç»Ÿè®¡å…³é”®è¯
          if (Array.isArray(lit.keywords)) {
            lit.keywords.forEach(kw => {
              const kwCount = author.keywords.get(kw) || 0;
              author.keywords.set(kw, kwCount + 1);
            });
          }

          // ç»Ÿè®¡æœŸåˆŠ
          if (lit.journal) {
            const journalCount = author.journals.get(lit.journal) || 0;
            author.journals.set(lit.journal, journalCount + 1);
          }

          // ç»Ÿè®¡åˆä½œè€…
          if (Array.isArray(lit.authors)) {
            lit.authors.forEach(coauthor => {
              const coauthorName = coauthor.trim();
              if (coauthorName !== name) {  // æ’é™¤è‡ªå·±
                const coauthorCount = author.coauthors.get(coauthorName) || 0;
                author.coauthors.set(coauthorName, coauthorCount + 1);
              }
            });
          }
        });
      });

      // åå¤„ç†ï¼šè®¡ç®—å¹´ä»½èŒƒå›´ã€æ’åºæ–‡çŒ®ç­‰
      state.authors.forEach(author => {
        if (author.years.length > 0) {
          author.yearStart = Math.min(...author.years);
          author.yearEnd = Math.max(...author.years);
          author.yearRange = author.yearStart === author.yearEnd
            ? `${author.yearStart}`
            : `${author.yearStart}-${author.yearEnd}`;
        }

        // æŒ‰æœŸåˆŠé‡è¦æ€§å’Œå¹´ä»½æ’åºæ–‡çŒ®
        // 1. è®¡ç®—æ¯ä¸ªæœŸåˆŠçš„æƒé‡ï¼ˆè¯¥ä½œè€…åœ¨è¯¥æœŸåˆŠå‘è¡¨çš„æ–‡çŒ®æ•°ï¼‰
        const journalWeights = new Map();
        author.literatures.forEach(lit => {
          if (lit.journal) {
            journalWeights.set(lit.journal, (journalWeights.get(lit.journal) || 0) + 1);
          }
        });

        // 2. æŒ‰æœŸåˆŠæƒé‡å’Œå¹´ä»½æ’åº
        author.topLiteratures = author.literatures
          .slice()
          .sort((a, b) => {
            // ä¼˜å…ˆæŒ‰æœŸåˆŠæƒé‡æ’åº
            const weightA = journalWeights.get(a.journal) || 0;
            const weightB = journalWeights.get(b.journal) || 0;
            if (weightA !== weightB) {
              return weightB - weightA;
            }
            // åŒä¸€æœŸåˆŠæŒ‰å¹´ä»½é™åº
            return b.year - a.year;
          })
          .slice(0, 10);

        // è½¬æ¢ä¸ºæ’åºåçš„æ•°ç»„ä¾¿äºæ¸²æŸ“
        author.topKeywords = Array.from(author.keywords.entries())
          .sort((a, b) => b[1] - a[1])
          .slice(0, 10);

        author.topCoauthors = Array.from(author.coauthors.entries())
          .sort((a, b) => b[1] - a[1])
          .slice(0, 5);

        author.topJournals = Array.from(author.journals.entries())
          .sort((a, b) => b[1] - a[1])
          .slice(0, 5);
      });
    }

    // ==================== æœŸåˆŠæ•°æ®å¤„ç† ====================

    /**
     * æå–æ‰€æœ‰æœŸåˆŠåŠç»Ÿè®¡ä¿¡æ¯
     */
    function extractJournals() {
      state.journals.clear();

      // éå†ç­›é€‰åçš„æ–‡çŒ®
      state.filteredLiteratures.forEach(lit => {
        const journalName = lit.journal;
        if (!journalName || !journalName.trim()) return;

        const name = journalName.trim();

        if (!state.journals.has(name)) {
          // è·å–æœŸåˆŠåˆ†çº§
          const tier = getJournalTier(name);
          const autoScore = tierToScore(tier);

          // è·å–ç”¨æˆ·æ‰“æ˜Ÿ
          const manualStars = state.journalStarRatings.get(name) || 0;

          // è®¡ç®—æœ€ç»ˆå¾—åˆ†
          const finalScore = calculateJournalScore(autoScore, manualStars);

          // åˆå§‹åŒ–æœŸåˆŠæ•°æ®
          state.journals.set(name, {
            name: name,
            tier: tier,
            autoScore: autoScore,
            manualStars: manualStars,
            finalScore: finalScore,
            count: 0,
            literatures: [],
            years: [],
            yearDistribution: new Map()
          });
        }

        const journal = state.journals.get(name);
        journal.count++;
        journal.literatures.push(lit);
        journal.years.push(lit.year);

        // ç»Ÿè®¡å¹´ä»½åˆ†å¸ƒ
        const yearCount = journal.yearDistribution.get(lit.year) || 0;
        journal.yearDistribution.set(lit.year, yearCount + 1);
      });

      // åå¤„ç†ï¼šè®¡ç®—å¹´ä»½èŒƒå›´ç­‰
      state.journals.forEach(journal => {
        if (journal.years.length > 0) {
          journal.yearStart = Math.min(...journal.years);
          journal.yearEnd = Math.max(...journal.years);
          journal.yearRange = journal.yearStart === journal.yearEnd
            ? `${journal.yearStart}`
            : `${journal.yearStart}-${journal.yearEnd}`;
        }

        // ç”Ÿæˆæœ€æ–°æ–‡çŒ®åˆ—è¡¨ï¼ˆæŒ‰å¹´ä»½é™åºï¼Œå–å‰5ç¯‡ï¼‰
        journal.recentPapers = journal.literatures
          .slice()
          .sort((a, b) => b.year - a.year)
          .slice(0, 5);
      });
    }

    /**
     * å¯¹æœŸåˆŠåˆ—è¡¨æ’åº
     * @param {Array} journals - æœŸåˆŠæ•°ç»„
     * @returns {Array} æ’åºåçš„æœŸåˆŠæ•°ç»„
     */
    function sortJournals(journals) {
      return journals.sort((a, b) => {
        // æŒ‰æœ€ç»ˆå¾—åˆ†é™åº
        if (b.finalScore !== a.finalScore) {
          return b.finalScore - a.finalScore;
        }
        // å¾—åˆ†ç›¸åŒæŒ‰æ–‡çŒ®æ•°é™åº
        return b.count - a.count;
      });
    }

    /**
     * åº”ç”¨ç­›é€‰å™¨
     */
    function applyFilters() {
      const { searchQuery, filters } = state;

      let results = state.literatures.filter(lit => {
        // ç±»å‹ç­›é€‰
        if (filters.activeType !== 'all' && lit.type !== filters.activeType) {
          return false;
        }

        // å¹´ä»½ç­›é€‰
        if (lit.year < filters.yearStart || lit.year > filters.yearEnd) {
          return false;
        }

        // æœŸåˆŠç­›é€‰
        if (filters.activeVenue !== 'all' && lit.journal !== filters.activeVenue) {
          return false;
        }

        // æœç´¢å…³é”®è¯
        if (searchQuery) {
          const searchText = [
            lit.title || '',
            (lit.authors || []).join(' '),
            (lit.keywords || []).join(' '),
            String(lit.year),
            lit.journal || ''
          ].join(' ').toLowerCase();

          const keywords = searchQuery.toLowerCase().split(/\s+/);
          return keywords.every(keyword => searchText.includes(keyword));
        }

        return true;
      });

      // æ’åºï¼šæ˜Ÿæ ‡ä¼˜å…ˆï¼ŒåŒçº§æŒ‰å¹´ä»½é™åº
      results = sortLiteratures(results);

      state.filteredLiteratures = results;
      state.pagination.currentPage = 1;
      state.pagination.hasMore = results.length > state.pagination.pageSize;

      // æå–ä½œè€…ä¿¡æ¯
      extractAuthors();

      // æå–æœŸåˆŠä¿¡æ¯
      extractJournals();

      updateDisplay();
    }

    /**
     * æ›´æ–°æ˜¾ç¤º
     */
    function updateDisplay() {
      const { currentPage, pageSize } = state.pagination;
      const startIndex = 0;
      const endIndex = currentPage * pageSize;

      state.displayedLiteratures = state.filteredLiteratures.slice(startIndex, endIndex);
      state.pagination.hasMore = endIndex < state.filteredLiteratures.length;

      renderTabs();
      renderLiteratures();
      updateSearchCount();
      updateLoadMoreButton();
    }

    /**
     * åŠ è½½æ›´å¤š
     */
    function loadMore() {
      state.pagination.currentPage++;
      updateDisplay();
    }

    // ==================== æ¸²æŸ“å‡½æ•° ====================

    /**
     * æ¸²æŸ“ç­›é€‰å™¨
     */
    function renderFilters() {
      // æ¸²æŸ“ç±»å‹ç­›é€‰
      const types = [
        { key: 'all', label: 'å…¨éƒ¨ç±»å‹' },
        { key: 'article', label: 'æœŸåˆŠè®ºæ–‡' },
        { key: 'inproceedings', label: 'ä¼šè®®è®ºæ–‡' },
        { key: 'book', label: 'ä¹¦ç±' },
        { key: 'phdthesis', label: 'åšå£«è®ºæ–‡' },
        { key: 'mastersthesis', label: 'ç¡•å£«è®ºæ–‡' }
      ];

      dom.typeFilters.innerHTML = types.map(type => `
        <div class="pill ${state.filters.activeType === type.key ? 'active' : ''}"
             data-type="${type.key}">
          ${type.label}
        </div>
      `).join('');

      // æ¸²æŸ“æœŸåˆŠç­›é€‰
      const venues = ['all', ...Array.from(state.availableVenues)];
      dom.venueFilters.innerHTML = venues.map(venue => `
        <div class="pill ${state.filters.activeVenue === venue ? 'active' : ''}"
             data-venue="${venue}">
          ${venue === 'all' ? 'å…¨éƒ¨æœŸåˆŠ' : venue}
        </div>
      `).join('');
    }

    /**
     * æ¸²æŸ“Tabå¯¼èˆª
     */
    function renderTabs() {
      const pinnedCount = state.pinnedLiteratures.size;
      const allCount = state.filteredLiteratures.length;
      const authorCount = state.authors.size;
      const journalCount = state.journals.size;

      const tabsHtml = `
        <div class="tab ${state.currentView === 'all' ? 'active' : ''}" data-view="all">
          ğŸ“š å…¨éƒ¨ (${allCount})
        </div>
        <div class="tab ${state.currentView === 'pinned' ? 'active' : ''}" data-view="pinned">
          â­ æ˜Ÿæ ‡ (${pinnedCount})
        </div>
        <div class="tab ${state.currentView === 'author' ? 'active' : ''}" data-view="author">
          ğŸ‘¤ ä½œè€… (${authorCount})
        </div>
        <div class="tab ${state.currentView === 'journal' ? 'active' : ''}" data-view="journal">
          ğŸ“– æœŸåˆŠ (${journalCount})
        </div>
      `;

      dom.viewTabs.innerHTML = tabsHtml;
    }

    /**
     * åˆ‡æ¢è§†å›¾
     */
    function switchView(viewKey) {
      state.currentView = viewKey;

      // åˆ‡æ¢è§†å›¾æ—¶é‡ç½®æ‰€æœ‰å±•å¼€å’Œé€‰ä¸­çŠ¶æ€
      state.selectedAuthor = null;
      state.expandedAuthor = null;
      state.selectedJournal = null;
      state.expandedJournal = null;
      state.expandedId = null;
      hideBackdrop();

      renderTabs();
      renderLiteratures();
    }

    /**
     * æ¸²æŸ“æ–‡çŒ®åˆ—è¡¨(åŸºäºå½“å‰è§†å›¾)
     */
    function renderLiteratures() {
      // ä½œè€…è§†å›¾ç‰¹æ®Šå¤„ç†
      if (state.currentView === 'author') {
        if (state.selectedAuthor) {
          // æ˜¾ç¤ºæŸä¸ªä½œè€…çš„æ–‡çŒ®åˆ—è¡¨
          renderAuthorLiteratures(state.selectedAuthor);
        } else {
          // æ˜¾ç¤ºæ‰€æœ‰ä½œè€…åˆ—è¡¨
          renderAuthors();
        }
        return;
      }

      // æœŸåˆŠè§†å›¾ç‰¹æ®Šå¤„ç†
      if (state.currentView === 'journal') {
        if (state.selectedJournal) {
          // æ˜¾ç¤ºæŸä¸ªæœŸåˆŠçš„æ–‡çŒ®åˆ—è¡¨
          renderJournalLiteratures(state.selectedJournal);
        } else {
          // æ˜¾ç¤ºæ‰€æœ‰æœŸåˆŠåˆ—è¡¨
          renderJournals();
        }
        return;
      }

      // æ ¹æ®å½“å‰è§†å›¾è¿‡æ»¤æ•°æ®
      let displayData = [];

      switch (state.currentView) {
        case 'pinned':
          displayData = state.displayedLiteratures.filter(lit =>
            state.pinnedLiteratures.has(lit.id)
          );
          break;
        case 'all':
        default:
          displayData = state.displayedLiteratures;
          break;
      }

      // ç©ºçŠ¶æ€
      if (displayData.length === 0) {
        const emptyMessage = state.currentView === 'pinned'
          ? 'è¿˜æ²¡æœ‰æ˜Ÿæ ‡æ–‡çŒ®<br>ç‚¹å‡»å¡ç‰‡ä¸Šçš„ â˜† æ·»åŠ æ˜Ÿæ ‡'
          : 'æœªæ‰¾åˆ°æ–‡çŒ®<br>å°è¯•è°ƒæ•´æœç´¢å…³é”®è¯æˆ–ç­›é€‰æ¡ä»¶';

        dom.literatureGrid.innerHTML = `
          <div class="empty-state">
            <div style="font-size: 48px; margin-bottom: 16px;">
              ${state.currentView === 'pinned' ? 'â­' : 'ğŸ“š'}
            </div>
            <h3>${emptyMessage.split('<br>')[0]}</h3>
            <p>${emptyMessage.split('<br>')[1]}</p>
          </div>
        `;
        return;
      }

      // æ¸²æŸ“å¡ç‰‡
      dom.literatureGrid.className = 'literature-grid';
      dom.literatureGrid.innerHTML = displayData
        .map(lit => renderLiteratureCard(lit))
        .join('');
    }

    /**
     * æ¸²æŸ“å•ä¸ªæ–‡çŒ®å¡ç‰‡
     */
    function renderLiteratureCard(lit) {
      const isSelected = state.selectedId === lit.id;
      const isExpanded = isSelected && state.expandedId === lit.id;
      const isPinned = state.pinnedLiteratures.has(lit.id);
      const typeColor = getTypeColor(lit.type);
      const typeName = getTypeName(lit.type);

      // ä½œè€…æ˜¾ç¤ºï¼ˆæœ€å¤š3ä¸ªï¼Œå…¶ä½™æ˜¾ç¤º et al.ï¼‰
      const authorsDisplay = Array.isArray(lit.authors)
        ? (lit.authors.length <= 3
            ? lit.authors.join(', ')
            : `${lit.authors.slice(0, 3).join(', ')} et al.`)
        : '';

      return `
        <div class="literature-card ${isSelected ? 'selected' : ''} ${isExpanded ? 'expanded' : ''}"
             data-id="${lit.id}"
             style="border-left-color: ${typeColor}">

          <!-- æ“ä½œå›¾æ ‡ -->
          <div class="card-actions">
            <div class="action-icon pin-icon ${isPinned ? 'pinned' : ''}"
                 data-action="pin"
                 title="${isPinned ? 'å–æ¶ˆæ˜Ÿæ ‡' : 'æ·»åŠ æ˜Ÿæ ‡'}">
              ${isPinned ? 'â­' : 'â˜†'}
            </div>
            <div class="action-icon" data-action="focus" title="åœ¨ MarginNote ä¸­å®šä½">ğŸ“</div>
            <div class="action-icon" data-action="pdf" title="æ‰“å¼€ PDF">ğŸ“„</div>
          </div>

          <!-- å¡ç‰‡å¤´éƒ¨ -->
          <div class="card-header">
            <div class="card-type-badge" style="background: ${typeColor}">
              ${typeName}
            </div>
            <div class="card-title">${highlightText(lit.title, state.searchQuery)}</div>
            ${authorsDisplay ? `<div class="card-authors">${highlightText(authorsDisplay, state.searchQuery)}</div>` : ''}

            <div class="card-meta">
              <span class="meta-item">${lit.year}</span>
              ${lit.journal ? `
                <span class="meta-divider"></span>
                <span class="meta-item">${lit.journal.toTitleCase()}</span>
              ` : ''}
            </div>
          </div>

          <!-- å…³é”®è¯ -->
          ${lit.keywords && lit.keywords.length > 0 ? `
            <div class="card-keywords">
              ${lit.keywords.slice(0, 5).map(kw => `
                <span class="keyword-tag" data-keyword="${escapeHtml(kw)}" title="ç‚¹å‡»æœç´¢è¯¥å…³é”®è¯">${kw}</span>
              `).join('')}
            </div>
          ` : ''}

          <!-- å±•å¼€çš„è¯¦æƒ… -->
          <div class="card-details">
            ${lit.abstract ? `
              <div class="detail-section">
                <div class="detail-label">æ‘˜è¦</div>
                <div class="detail-content">${escapeHtml(lit.abstract)}</div>
              </div>
            ` : ''}

            ${lit.doi ? `
              <div class="detail-section">
                <div class="detail-label">DOI</div>
                <div class="detail-content">${lit.doi}</div>
              </div>
            ` : ''}

            <div class="detail-actions">
              <button class="btn" onclick="handleAction('focus', '${lit.id}')">åœ¨ MarginNote ä¸­æŸ¥çœ‹</button>
              <button class="btn" onclick="handleAction('bibtex', '${lit.id}')">å¯¼å‡º BibTeX</button>
            </div>
          </div>
        </div>
      `;
    }

    /**
     * è·å–ä½œè€…åå­—çš„é¦–å­—æ¯ï¼ˆç”¨äºå¤´åƒï¼‰
     * @param {string} name - ä½œè€…åå­—
     * @returns {string} é¦–å­—æ¯
     */
    function getAuthorInitial(name) {
      if (!name) return '?';

      // å¦‚æœæ˜¯ä¸­æ–‡åï¼Œå–ç¬¬ä¸€ä¸ªå­—
      if (/[\u4e00-\u9fa5]/.test(name)) {
        return name.charAt(0);
      }

      // å¦‚æœæ˜¯è‹±æ–‡åï¼Œå–é¦–å­—æ¯
      const parts = name.trim().split(/\s+/);
      if (parts.length > 1) {
        // å–åå’Œå§“çš„é¦–å­—æ¯
        return (parts[0].charAt(0) + parts[parts.length - 1].charAt(0)).toUpperCase();
      }

      return name.charAt(0).toUpperCase();
    }

    /**
     * æ¸²æŸ“ç ”ç©¶è¶‹åŠ¿å›¾è¡¨
     * @param {Object} author - ä½œè€…æ•°æ®
     * @returns {string} HTML
     */
    function renderTrendChart(author) {
      // è·å–æ’åºåçš„å¹´ä»½
      const years = Array.from(author.yearDistribution.keys()).sort();
      if (years.length === 0) return '<p style="color: var(--muted); font-size: 12px;">æš‚æ— æ•°æ®</p>';

      const maxCount = Math.max(...author.yearDistribution.values());

      return years.map(year => {
        const count = author.yearDistribution.get(year);
        const percentage = (count / maxCount) * 100;

        return `
          <div class="trend-bar">
            <div class="trend-year">${year}</div>
            <div class="trend-bar-container">
              <div class="trend-bar-fill" style="width: ${percentage}%"></div>
            </div>
            <div class="trend-count">${count}ç¯‡</div>
          </div>
        `;
      }).join('');
    }

    /**
     * æ¸²æŸ“å…³é”®è¯æ ‡ç­¾äº‘
     * @param {Object} author - ä½œè€…æ•°æ®
     * @returns {string} HTML
     */
    function renderKeywords(author) {
      if (!author.topKeywords || author.topKeywords.length === 0) {
        return '<p style="color: var(--muted); font-size: 12px;">æš‚æ— å…³é”®è¯</p>';
      }

      return author.topKeywords.map(([keyword, count]) => `
        <div class="author-keyword-tag">
          <span>${escapeHtml(keyword)}</span>
          <span class="keyword-count">${count}</span>
        </div>
      `).join('');
    }

    /**
     * æ¸²æŸ“æ–‡çŒ®åˆ—è¡¨é¢„è§ˆ
     * @param {Object} author - ä½œè€…æ•°æ®
     * @returns {string} HTML
     */
    function renderLitPreview(author) {
      if (!author.topLiteratures || author.topLiteratures.length === 0) {
        return '<p style="color: var(--muted); font-size: 12px;">æš‚æ— æ–‡çŒ®</p>';
      }

      return author.topLiteratures.slice(0, 5).map(lit => `
        <div class="author-lit-item" data-lit-id="${lit.id}">
          <div class="author-lit-title">${escapeHtml(lit.title)}</div>
          <div class="author-lit-meta">
            <span>${lit.year}</span>
            ${lit.journal ? `<span>â€¢</span><span>${escapeHtml(lit.journal.toTitleCase())}</span>` : ''}
          </div>
        </div>
      `).join('');
    }

    /**
     * æ¸²æŸ“åˆä½œè€…åˆ—è¡¨
     * @param {Object} author - ä½œè€…æ•°æ®
     * @returns {string} HTML
     */
    function renderCoauthors(author) {
      if (!author.topCoauthors || author.topCoauthors.length === 0) {
        return '<p style="color: var(--muted); font-size: 12px;">æš‚æ— åˆä½œè€…</p>';
      }

      return author.topCoauthors.map(([name, count]) => {
        const initial = getAuthorInitial(name);
        return `
          <div class="coauthor-item" data-author="${escapeHtml(name)}">
            <div class="coauthor-avatar">${initial}</div>
            <div class="coauthor-name">${escapeHtml(name)}</div>
            <div class="coauthor-count">(${count}ç¯‡)</div>
          </div>
        `;
      }).join('');
    }

    /**
     * æ¸²æŸ“ä½œè€…çš„å‘è¡¨æœŸåˆŠåˆ†å¸ƒ
     * @param {Object} author - ä½œè€…æ•°æ®
     * @returns {string} HTML
     */
    function renderAuthorJournals(author) {
      if (!author.topJournals || author.topJournals.length === 0) {
        return '<p style="color: var(--muted); font-size: 12px;">æš‚æ— æœŸåˆŠä¿¡æ¯</p>';
      }

      const html = author.topJournals.map((item) => {
        // å®¹é”™å¤„ç†
        const journal = Array.isArray(item) ? item[0] : (item.journal || item);
        const count = Array.isArray(item) ? item[1] : (item.count || 1);

        return `
          <div class="journal-item">
            <div class="journal-name">${escapeHtml(journal.toTitleCase())}</div>
            <div class="journal-count">${count}ç¯‡</div>
          </div>
        `;
      }).join('');

      return html;
    }

    /**
     * æ¸²æŸ“ä½œè€…åˆ—è¡¨
     */
    function renderAuthors() {
      // è½¬æ¢ Map ä¸ºæ•°ç»„å¹¶æŒ‰æ–‡çŒ®æ•°é‡æ’åº
      const authorsArray = Array.from(state.authors.values())
        .sort((a, b) => b.count - a.count);

      // ç©ºçŠ¶æ€
      if (authorsArray.length === 0) {
        dom.literatureGrid.innerHTML = `
          <div class="empty-state">
            <div style="font-size: 48px; margin-bottom: 16px;">ğŸ‘¤</div>
            <h3>æœªæ‰¾åˆ°ä½œè€…</h3>
            <p>å°è¯•è°ƒæ•´æœç´¢å…³é”®è¯æˆ–ç­›é€‰æ¡ä»¶</p>
          </div>
        `;
        return;
      }

      // æ¸²æŸ“ä½œè€…å¡ç‰‡
      dom.literatureGrid.className = 'author-grid';
      dom.literatureGrid.innerHTML = authorsArray
        .map(author => {
          const initial = getAuthorInitial(author.name);
          const isExpanded = state.expandedAuthor === author.name;

          return `
            <div class="author-card ${isExpanded ? 'expanded' : ''}" data-author="${escapeHtml(author.name)}">
              <!-- å…³é—­æŒ‰é’® -->
              <div class="author-close-btn" data-action="close-author">Ã—</div>

              <!-- ä½œè€…å¤´éƒ¨ -->
              <div class="author-card-header">
                <div class="author-avatar">${initial}</div>
                <div class="author-info">
                  <div class="author-name">${highlightText(author.name, state.searchQuery)}</div>
                  <div class="author-role">ç ”ç©¶è€…</div>
                </div>
              </div>

              <!-- ç»Ÿè®¡ä¿¡æ¯ -->
              <div class="author-stats">
                <div class="author-stat-item">
                  <div class="author-stat-value">${author.count}</div>
                  <div class="author-stat-label">æ–‡çŒ®</div>
                </div>
                <div class="author-stat-item">
                  <div class="author-stat-value">${author.yearRange || 'N/A'}</div>
                  <div class="author-stat-label">å¹´ä»½</div>
                </div>
                <div class="author-stat-item">
                  <div class="author-stat-value">${author.topJournals ? author.topJournals.length : 0}</div>
                  <div class="author-stat-label">æœŸåˆŠ</div>
                </div>
              </div>

              <!-- è¯¦æƒ…åŒºåŸŸï¼ˆå±•å¼€æ—¶æ˜¾ç¤ºï¼‰ -->
              <div class="author-card-details">
                <!-- ç ”ç©¶è¶‹åŠ¿ -->
                <div class="detail-section">
                  <h4>ğŸ“ˆ ç ”ç©¶è¶‹åŠ¿</h4>
                  <div class="author-trend-chart">
                    ${renderTrendChart(author)}
                  </div>
                </div>

                <!-- ç ”ç©¶é¢†åŸŸ -->
                <div class="detail-section">
                  <h4>ğŸ·ï¸ ç ”ç©¶é¢†åŸŸ</h4>
                  <div class="author-keywords">
                    ${renderKeywords(author)}
                  </div>
                </div>

                <!-- ä»£è¡¨æ–‡çŒ® -->
                <div class="detail-section">
                  <h4>ğŸ“š ä»£è¡¨æ–‡çŒ®</h4>
                  <div class="author-lit-preview">
                    ${renderLitPreview(author)}
                  </div>
                </div>

                <!-- åˆä½œç½‘ç»œ -->
                <div class="detail-section">
                  <h4>ğŸ‘¥ åˆä½œç½‘ç»œ</h4>
                  <div class="author-coauthors">
                    ${renderCoauthors(author)}
                  </div>
                </div>

                <!-- å‘è¡¨æœŸåˆŠ -->
                <div class="detail-section">
                  <h4>ğŸ“– å‘è¡¨æœŸåˆŠ</h4>
                  <div class="author-journals">
                    ${renderAuthorJournals(author)}
                  </div>
                </div>

                <!-- æ“ä½œæŒ‰é’® -->
                <div class="detail-actions">
                  <button class="btn primary" data-action="view-all-lit">æŸ¥çœ‹å…¨éƒ¨æ–‡çŒ® (${author.count}ç¯‡)</button>
                </div>
              </div>
            </div>
          `;
        })
        .join('');
    }

    /**
     * æ¸²æŸ“æŸä¸ªä½œè€…çš„æ–‡çŒ®åˆ—è¡¨
     */
    function renderAuthorLiteratures(authorName) {
      const author = state.authors.get(authorName);
      if (!author) {
        showToast("æœªæ‰¾åˆ°è¯¥ä½œè€…");
        state.selectedAuthor = null;
        renderAuthors();
        return;
      }

      // æ¸²æŸ“å¤´éƒ¨ï¼ˆè¿”å›æŒ‰é’® + ä½œè€…ä¿¡æ¯ï¼‰
      const headerHtml = `
        <div class="author-view-header">
          <button class="author-view-back" id="authorViewBack">
            â† è¿”å›
          </button>
          <div class="author-view-info">
            ${author.name} çš„æ–‡çŒ® (${author.count} ç¯‡)
          </div>
        </div>
      `;

      // æ¸²æŸ“æ–‡çŒ®å¡ç‰‡
      dom.literatureGrid.className = 'literature-grid';
      dom.literatureGrid.innerHTML = headerHtml + author.literatures
        .map(lit => renderLiteratureCard(lit))
        .join('');
    }

    // ==================== æœŸåˆŠæ¸²æŸ“å‡½æ•° ====================

    /**
     * æ¸²æŸ“æœŸåˆŠåˆ—è¡¨
     */
    function renderJournals() {
      // è½¬æ¢ Map ä¸ºæ•°ç»„å¹¶æ’åº
      const journalsArray = sortJournals(Array.from(state.journals.values()));

      // ç©ºçŠ¶æ€
      if (journalsArray.length === 0) {
        dom.literatureGrid.innerHTML = `
          <div class="empty-state">
            <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“–</div>
            <h3>æœªæ‰¾åˆ°æœŸåˆŠ</h3>
            <p>å°è¯•è°ƒæ•´æœç´¢å…³é”®è¯æˆ–ç­›é€‰æ¡ä»¶</p>
          </div>
        `;
        return;
      }

      // æ¸²æŸ“æœŸåˆŠå¡ç‰‡
      dom.literatureGrid.className = 'journal-grid';
      dom.literatureGrid.innerHTML = journalsArray
        .map(journal => renderJournalCard(journal))
        .join('');
    }

    /**
     * æ¸²æŸ“å•ä¸ªæœŸåˆŠå¡ç‰‡
     * @param {Object} journal - æœŸåˆŠå¯¹è±¡
     * @returns {string} HTML
     */
    function renderJournalCard(journal) {
      const isExpanded = state.expandedJournal === journal.name;
      const tierClass = journal.tier ? `tier-${journal.tier.toLowerCase()}` : 'tier-unranked';
      const tierLabel = journal.tier || 'æœªåˆ†çº§';

      return `
        <div class="journal-card ${tierClass} ${isExpanded ? 'expanded' : ''}"
             data-journal="${escapeHtml(journal.name)}">

          <!-- å…³é—­æŒ‰é’® -->
          <div class="journal-close-btn" data-action="close-journal">Ã—</div>

          <!-- æœŸåˆŠå¤´éƒ¨ -->
          <div class="journal-card-header">
            <div class="journal-info-main">
              <div class="journal-tier-badge ${tierClass}">${tierLabel}</div>
              <div class="journal-name">${highlightJournalName(journal.name, state.searchQuery)}</div>
            </div>

            <!-- è¯„åˆ†åŒºåŸŸ -->
            <div class="journal-scores">
              <div class="journal-final-score">${journal.finalScore.toFixed(1)}</div>
              <div class="journal-score-label">æœ€ç»ˆå¾—åˆ†</div>
              ${renderJournalStars(journal)}
            </div>
          </div>

          <!-- ç»Ÿè®¡ä¿¡æ¯ -->
          <div class="journal-stats">
            <div class="journal-stat-item">
              <div class="journal-stat-value">${journal.count}</div>
              <div class="journal-stat-label">æ–‡çŒ®æ•°</div>
            </div>
            <div class="journal-stat-item">
              <div class="journal-stat-value">${journal.yearRange || 'N/A'}</div>
              <div class="journal-stat-label">å¹´ä»½</div>
            </div>
          </div>

          <!-- è¯¦æƒ…åŒºåŸŸï¼ˆå±•å¼€æ—¶æ˜¾ç¤ºï¼‰ -->
          <div class="journal-card-details">
            <!-- å¹´ä»½åˆ†å¸ƒ -->
            <div class="detail-section">
              <h4>ğŸ“ˆ å¹´ä»½åˆ†å¸ƒ</h4>
              <div class="journal-trend-chart">
                ${renderJournalTrendChart(journal)}
              </div>
            </div>

            <!-- æœ€æ–°æ–‡çŒ® -->
            <div class="detail-section">
              <h4>ğŸ†• æœ€æ–°å‘è¡¨ (${journal.recentPapers ? journal.recentPapers.length : 0}ç¯‡)</h4>
              <div class="journal-rep-papers">
                ${renderRecentPapers(journal)}
              </div>
            </div>

            <!-- æ“ä½œæŒ‰é’® -->
            <div class="journal-actions">
              <button class="btn primary" data-action="view-all-journal-lit">æŸ¥çœ‹å…¨éƒ¨æ–‡çŒ® (${journal.count}ç¯‡)</button>
            </div>
          </div>
        </div>
      `;
    }

    /**
     * æ¸²æŸ“æœŸåˆŠæ‰“æ˜Ÿç»„ä»¶
     * @param {Object} journal - æœŸåˆŠå¯¹è±¡
     * @returns {string} HTML
     */
    function renderJournalStars(journal) {
      const stars = journal.manualStars || 0;
      let html = '<div class="journal-star-rating">';

      for (let i = 1; i <= 5; i++) {
        const filled = i <= stars;
        html += `<span class="star-icon ${filled ? 'filled' : ''}"
                      data-action="rate-journal"
                      data-star="${i}">â˜…</span>`;
      }

      html += '</div>';
      return html;
    }

    /**
     * æ¸²æŸ“å¹´ä»½åˆ†å¸ƒå›¾è¡¨
     * @param {Object} journal - æœŸåˆŠå¯¹è±¡
     * @returns {string} HTML
     */
    function renderJournalTrendChart(journal) {
      const years = Array.from(journal.yearDistribution.keys()).sort();
      if (years.length === 0) {
        return '<p style="color: var(--muted); font-size: 12px;">æš‚æ— æ•°æ®</p>';
      }

      const maxCount = Math.max(...journal.yearDistribution.values());

      return years.map(year => {
        const count = journal.yearDistribution.get(year);
        const percentage = (count / maxCount) * 100;

        return `
          <div class="journal-trend-bar">
            <div class="journal-trend-year">${year}</div>
            <div class="journal-trend-bar-container">
              <div class="journal-trend-bar-fill" style="width: ${percentage}%"></div>
            </div>
            <div class="journal-trend-count">${count}ç¯‡</div>
          </div>
        `;
      }).join('');
    }

    /**
     * æ¸²æŸ“æœ€æ–°æ–‡çŒ®åˆ—è¡¨
     * @param {Object} journal - æœŸåˆŠå¯¹è±¡
     * @returns {string} HTML
     */
    function renderRecentPapers(journal) {
      if (!journal.recentPapers || journal.recentPapers.length === 0) {
        return '<p style="color: var(--muted); font-size: 12px;">æš‚æ— æ•°æ®</p>';
      }

      return journal.recentPapers.map(lit => `
        <div class="journal-rep-paper-item" data-lit-id="${lit.id}">
          <div class="journal-rep-paper-title">${escapeHtml(lit.title)}</div>
          <div class="journal-rep-paper-meta">
            <span>ğŸ“… ${lit.year}</span>
            ${lit.authors && lit.authors.length > 0 ? `<span>â€¢</span><span>${escapeHtml(lit.authors[0])}</span>` : ''}
          </div>
        </div>
      `).join('');
    }

    /**
     * æ¸²æŸ“æŸä¸ªæœŸåˆŠçš„æ–‡çŒ®åˆ—è¡¨
     */
    function renderJournalLiteratures(journalName) {
      const journal = state.journals.get(journalName);
      if (!journal) {
        showToast("æœªæ‰¾åˆ°è¯¥æœŸåˆŠ");
        state.selectedJournal = null;
        renderJournals();
        return;
      }

      // æ¸²æŸ“å¤´éƒ¨ï¼ˆè¿”å›æŒ‰é’® + æœŸåˆŠä¿¡æ¯ï¼‰
      const headerHtml = `
        <div class="journal-view-header">
          <button class="journal-view-back" id="journalViewBack">
            â† è¿”å›
          </button>
          <div class="journal-view-info">
            ${journal.name.toTitleCase()} çš„æ–‡çŒ® (${journal.count} ç¯‡)
          </div>
        </div>
      `;

      // æ¸²æŸ“æ–‡çŒ®å¡ç‰‡
      dom.literatureGrid.className = 'literature-grid';
      dom.literatureGrid.innerHTML = headerHtml + journal.literatures
        .map(lit => renderLiteratureCard(lit))
        .join('');
    }

    /**
     * æ›´æ–°æœç´¢è®¡æ•°
     */
    function updateSearchCount() {
      const count = state.filteredLiteratures.length;
      dom.searchCount.textContent = `${count} ç¯‡æ–‡çŒ®`;
    }

    /**
     * æ›´æ–°åŠ è½½æ›´å¤šæŒ‰é’®
     */
    function updateLoadMoreButton() {
      if (state.pagination.hasMore) {
        dom.loadMoreContainer.classList.add('show');
        const remaining = state.filteredLiteratures.length - state.displayedLiteratures.length;
        dom.loadMoreBtn.textContent = `åŠ è½½æ›´å¤š (å‰©ä½™ ${remaining} ç¯‡)`;
      } else {
        dom.loadMoreContainer.classList.remove('show');
      }
    }

    // ==================== äº‹ä»¶å¤„ç† ====================

    /**
     * å¤„ç†å¡ç‰‡ç‚¹å‡»
     */
    function handleCardClick(event) {
      const card = event.target.closest('.literature-card');
      if (!card) return;

      // å¦‚æœç‚¹å‡»çš„æ˜¯æ“ä½œå›¾æ ‡ï¼Œä¸å¤„ç†å¡ç‰‡ç‚¹å‡»
      if (event.target.closest('.action-icon') || event.target.closest('.btn')) {
        return;
      }

      const id = card.dataset.id;

      if (state.selectedId === id) {
        // ç¬¬äºŒæ¬¡ç‚¹å‡»ï¼šå±•å¼€/æ”¶èµ·è¯¦æƒ…
        if (state.expandedId === id) {
          // æ”¶èµ·è¯¦æƒ…
          state.expandedId = null;
          hideBackdrop();
        } else {
          // å±•å¼€è¯¦æƒ…
          state.expandedId = id;
          renderLiteratures();

          // å»¶è¿Ÿæ‰§è¡Œæ»šåŠ¨å’Œæ˜¾ç¤ºèƒŒæ™¯ï¼Œç­‰å¾… DOM æ›´æ–°
          setTimeout(() => {
            const expandedCard = document.querySelector('.literature-card.expanded');
            if (expandedCard) {
              scrollToCard(expandedCard);
              showBackdrop();
            }
          }, 50);
          return;
        }
      } else {
        // ç¬¬ä¸€æ¬¡ç‚¹å‡»ï¼šé€‰ä¸­å¡ç‰‡
        state.selectedId = id;
        state.expandedId = null;
        hideBackdrop();
      }

      renderLiteratures();
    }

    /**
     * å¤„ç†æ“ä½œæŒ‰é’®ç‚¹å‡»
     */
    function handleAction(action, id) {
      const lit = state.literatures.find(l => l.id === id);
      if (!lit) return;

      switch (action) {
        case 'pin':
          togglePin(id);
          showToast(state.pinnedLiteratures.has(id) ? 'âœ… å·²æ·»åŠ æ˜Ÿæ ‡' : 'å·²å–æ¶ˆæ˜Ÿæ ‡');
          break;
        case 'focus':
          postBridge('focusInMindMap', { id });
          showToast('æ­£åœ¨å®šä½åˆ° MarginNote...');
          break;
        case 'pdf':
          postBridge('openPDF', { id });
          showToast('æ­£åœ¨æ‰“å¼€ PDF...');
          break;
        case 'bibtex':
          postBridge('exportBibTeX', { id });
          showToast('å·²å¤åˆ¶ BibTeX');
          break;
      }
    }

    /**
     * å¤„ç†æœç´¢è¾“å…¥
     */
    const handleSearchInput = debounce(function() {
      state.searchQuery = dom.searchInput.value.trim();
      applyFilters();
    }, 300);

    /**
     * å¤„ç†ç­›é€‰å™¨åˆ‡æ¢
     */
    function handleFilterToggle() {
      const isShowing = dom.filtersPanel.classList.contains('show');

      if (isShowing) {
        dom.filtersPanel.classList.remove('show');
        dom.mainLayout.classList.remove('with-filters');
        dom.toggleFiltersBtn.textContent = 'ç­›é€‰';
      } else {
        dom.filtersPanel.classList.add('show');
        dom.mainLayout.classList.add('with-filters');
        dom.toggleFiltersBtn.textContent = 'æ”¶èµ·ç­›é€‰';
      }
    }

    /**
     * å¤„ç†æ¸…ç©ºæ“ä½œ
     */
    function handleClear() {
      dom.searchInput.value = '';
      state.searchQuery = '';
      state.filters.activeType = 'all';
      state.filters.yearStart = 2000;
      state.filters.yearEnd = 2030;
      state.filters.activeVenue = 'all';
      state.selectedId = null;
      state.expandedId = null;

      dom.yearStartRange.value = 2000;
      dom.yearEndRange.value = 2030;
      dom.yearStartLabel.textContent = '2000';
      dom.yearEndLabel.textContent = '2030';

      hideBackdrop();
      applyFilters();
      renderFilters();
      showToast('å·²æ¸…ç©ºç­›é€‰æ¡ä»¶');
    }

    // ==================== åˆå§‹åŒ– ====================

    function init() {
      // æ·»åŠ å…¨å±€é”™è¯¯ç›‘å¬
      window.addEventListener('error', (e) => {
        console.error('é¡µé¢é”™è¯¯:', e.message, e.filename, e.lineno, e.colno);
        showToast('âŒ åŠ è½½é”™è¯¯: ' + e.message);
      });

      // æ·»åŠ æœªæ•è·çš„ Promise é”™è¯¯ç›‘å¬
      window.addEventListener('unhandledrejection', (e) => {
        console.error('Promise é”™è¯¯:', e.reason);
        showToast('âŒ æ“ä½œå¤±è´¥: ' + (e.reason?.message || e.reason));
      });

      // åŠ è½½æ˜Ÿæ ‡æ•°æ®
      loadPinnedData();

      // åŠ è½½æœŸåˆŠæ•°æ®
      loadJournalStarData();

      // äº‹ä»¶ç›‘å¬
      dom.searchInput.addEventListener('input', handleSearchInput);
      dom.toggleFiltersBtn.addEventListener('click', handleFilterToggle);
      dom.clearBtn.addEventListener('click', handleClear);
      dom.refreshBtn.addEventListener('click', () => Bridge.refreshData());
      dom.loadMoreBtn.addEventListener('click', loadMore);
      dom.literatureGrid.addEventListener('click', handleCardClick);

      // ä½œè€…å¡ç‰‡ç‚¹å‡»å’Œè¿”å›æŒ‰é’®å¤„ç†ï¼ˆä½¿ç”¨äº‹ä»¶å§”æ‰˜ï¼‰
      dom.literatureGrid.addEventListener('click', (e) => {
        // å¤„ç†å…³é—­æŒ‰é’®ç‚¹å‡»
        const closeBtn = e.target.closest('.author-close-btn');
        if (closeBtn) {
          e.stopPropagation();
          state.expandedAuthor = null;
          hideBackdrop();
          renderAuthors();
          return;
        }

        // å¤„ç†"æŸ¥çœ‹å…¨éƒ¨æ–‡çŒ®"æŒ‰é’®
        const viewAllBtn = e.target.closest('[data-action="view-all-lit"]');
        if (viewAllBtn) {
          e.stopPropagation();
          const authorCard = viewAllBtn.closest('.author-card');
          const authorName = authorCard.dataset.author;
          state.selectedAuthor = authorName;
          state.expandedAuthor = null;
          hideBackdrop();
          renderLiteratures();
          return;
        }

        // å¤„ç†åˆä½œè€…ç‚¹å‡»ï¼ˆè·³è½¬åˆ°è¯¥ä½œè€…ï¼‰
        const coauthorItem = e.target.closest('.coauthor-item');
        if (coauthorItem) {
          e.stopPropagation();
          const coauthorName = coauthorItem.dataset.author;
          // å…³é—­å½“å‰å±•å¼€ï¼Œå±•å¼€æ–°ä½œè€…
          state.expandedAuthor = coauthorName;
          renderAuthors();

          // æ»šåŠ¨åˆ°å¯¹åº”çš„ä½œè€…å¡ç‰‡
          setTimeout(() => {
            const targetCard = document.querySelector(`.author-card[data-author="${coauthorName}"]`);
            if (targetCard && !targetCard.classList.contains('expanded')) {
              targetCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
          }, 100);
          return;
        }

        // å¤„ç†ä½œè€…å¡ç‰‡ç‚¹å‡»
        const authorCard = e.target.closest('.author-card');
        if (authorCard && !e.target.closest('.author-card-details')) {
          // åªæœ‰ç‚¹å‡»å¡ç‰‡å¤´éƒ¨æ‰è§¦å‘å±•å¼€/æ”¶èµ·
          const authorName = authorCard.dataset.author;

          // å¦‚æœæ˜¯ä½œè€…åˆ—è¡¨è§†å›¾
          if (state.currentView === 'author' && !state.selectedAuthor) {
            if (state.expandedAuthor === authorName) {
              // å†æ¬¡ç‚¹å‡»ï¼šæ”¶èµ·
              state.expandedAuthor = null;
              hideBackdrop();
            } else {
              // å±•å¼€æ‚¬æµ®æ˜¾ç¤º
              state.expandedAuthor = authorName;
              showBackdrop();
            }
            renderAuthors();
            return;
          }
        }

        // å¤„ç†è¿”å›æŒ‰é’®ç‚¹å‡»
        const backBtn = e.target.closest('.author-view-back');
        if (backBtn) {
          state.selectedAuthor = null;
          state.expandedAuthor = null;
          hideBackdrop();
          renderLiteratures();
          return;
        }

        // ============ æœŸåˆŠå¡ç‰‡äº‹ä»¶å¤„ç† ============

        // å¤„ç†æœŸåˆŠå…³é—­æŒ‰é’®ç‚¹å‡»
        const journalCloseBtn = e.target.closest('.journal-close-btn');
        if (journalCloseBtn) {
          e.stopPropagation();
          state.expandedJournal = null;
          hideBackdrop();
          renderJournals();
          return;
        }

        // å¤„ç†æœŸåˆŠæ‰“æ˜Ÿ
        const starIcon = e.target.closest('.star-icon');
        if (starIcon && starIcon.dataset.action === 'rate-journal') {
          e.stopPropagation();
          const journalCard = starIcon.closest('.journal-card');
          const journalName = journalCard.dataset.journal;
          const stars = parseInt(starIcon.dataset.star);

          // å¦‚æœç‚¹å‡»çš„æ˜¯å½“å‰æ˜Ÿçº§,åˆ™æ¸…é™¤è¯„åˆ†
          const currentStars = state.journalStarRatings.get(journalName) || 0;
          const newStars = (currentStars === stars) ? 0 : stars;

          toggleJournalStar(journalName, newStars);

          // ä»…æ›´æ–°å½“å‰å¡ç‰‡çš„æ˜Ÿçº§æ˜¾ç¤º,é¿å…é‡æ–°æ¸²æŸ“æ•´ä¸ªåˆ—è¡¨
          const starRating = journalCard.querySelector('.journal-star-rating');
          if (starRating) {
            starRating.innerHTML = Array.from({length: 5}, (_, i) => {
              const filled = (i + 1) <= newStars;
              return `<span class="star-icon ${filled ? 'filled' : ''}"
                           data-action="rate-journal"
                           data-star="${i + 1}">â˜…</span>`;
            }).join('');
          }

          // æ›´æ–°è¯„åˆ†æ˜¾ç¤º
          const scoreElement = journalCard.querySelector('.journal-final-score');
          if (scoreElement) {
            const journal = state.journals.get(journalName);
            scoreElement.textContent = journal.finalScore.toFixed(1);
          }

          showToast(newStars > 0 ? `âœ… å·²è¯„åˆ† ${newStars} æ˜Ÿ` : 'å·²æ¸…é™¤è¯„åˆ†');
          return;
        }

        // å¤„ç†"æŸ¥çœ‹å…¨éƒ¨æ–‡çŒ®"æŒ‰é’®
        const viewAllJournalBtn = e.target.closest('[data-action="view-all-journal-lit"]');
        if (viewAllJournalBtn) {
          e.stopPropagation();
          const journalCard = viewAllJournalBtn.closest('.journal-card');
          const journalName = journalCard.dataset.journal;
          state.selectedJournal = journalName;
          state.expandedJournal = null;
          hideBackdrop();
          renderLiteratures();
          return;
        }

        // å¤„ç†æœŸåˆŠå¡ç‰‡ç‚¹å‡»
        const journalCard = e.target.closest('.journal-card');
        if (journalCard && !e.target.closest('.journal-card-details')) {
          // åªæœ‰ç‚¹å‡»å¡ç‰‡å¤´éƒ¨æ‰è§¦å‘å±•å¼€/æ”¶èµ·
          const journalName = journalCard.dataset.journal;

          // å¦‚æœæ˜¯æœŸåˆŠåˆ—è¡¨è§†å›¾
          if (state.currentView === 'journal' && !state.selectedJournal) {
            if (state.expandedJournal === journalName) {
              // å†æ¬¡ç‚¹å‡»ï¼šæ”¶èµ·
              state.expandedJournal = null;
              hideBackdrop();
            } else {
              // å±•å¼€æ‚¬æµ®æ˜¾ç¤º
              state.expandedJournal = journalName;
              showBackdrop();
            }
            renderJournals();
            return;
          }
        }

        // å¤„ç†æœŸåˆŠè¿”å›æŒ‰é’®ç‚¹å‡»
        const journalBackBtn = e.target.closest('.journal-view-back');
        if (journalBackBtn) {
          state.selectedJournal = null;
          state.expandedJournal = null;
          hideBackdrop();
          renderLiteratures();
          return;
        }

        // ============ æ–‡çŒ®å¡ç‰‡ç‚¹å‡»è·³è½¬ ============

        // å¤„ç†ä½œè€…æ–‡çŒ®åˆ—è¡¨ä¸­çš„æ–‡çŒ®å¡ç‰‡ç‚¹å‡»
        const authorLitItem = e.target.closest('.author-lit-item');
        if (authorLitItem) {
          e.stopPropagation();
          const litId = authorLitItem.dataset.litId;

          // åˆ‡æ¢å›å…¨éƒ¨è§†å›¾
          state.currentView = 'all';
          state.selectedAuthor = null;
          state.expandedAuthor = null;
          hideBackdrop();

          // èšç„¦å¹¶å±•å¼€å¯¹åº”çš„æ–‡çŒ®å¡ç‰‡
          state.selectedId = litId;
          state.expandedId = litId;

          renderLiteratures();

          // ç­‰å¾… DOM æ›´æ–°åæ»šåŠ¨åˆ°å¡ç‰‡ä½ç½®
          setTimeout(() => {
            const targetCard = document.querySelector(`.literature-card[data-id="${litId}"]`);
            if (targetCard) {
              scrollToCard(targetCard);
              showBackdrop();
            }
          }, 100);

          showToast('ğŸ“ å·²å®šä½åˆ°æ–‡çŒ®');
          return;
        }

        // å¤„ç†æœŸåˆŠæ–‡çŒ®åˆ—è¡¨ä¸­çš„æ–‡çŒ®å¡ç‰‡ç‚¹å‡»
        const journalLitItem = e.target.closest('.journal-rep-paper-item');
        if (journalLitItem) {
          e.stopPropagation();
          const litId = journalLitItem.dataset.litId;

          // åˆ‡æ¢å›å…¨éƒ¨è§†å›¾
          state.currentView = 'all';
          state.selectedJournal = null;
          state.expandedJournal = null;
          hideBackdrop();

          // èšç„¦å¹¶å±•å¼€å¯¹åº”çš„æ–‡çŒ®å¡ç‰‡
          state.selectedId = litId;
          state.expandedId = litId;

          renderLiteratures();

          // ç­‰å¾… DOM æ›´æ–°åæ»šåŠ¨åˆ°å¡ç‰‡ä½ç½®
          setTimeout(() => {
            const targetCard = document.querySelector(`.literature-card[data-id="${litId}"]`);
            if (targetCard) {
              scrollToCard(targetCard);
              showBackdrop();
            }
          }, 100);

          showToast('ğŸ“ å·²å®šä½åˆ°æ–‡çŒ®');
          return;
        }
      });

      // Tab åˆ‡æ¢
      dom.viewTabs.addEventListener('click', (e) => {
        const tab = e.target.closest('.tab');
        if (!tab || tab.classList.contains('disabled')) return;

        const viewKey = tab.dataset.view;
        switchView(viewKey);
      });

      // ç±»å‹ç­›é€‰
      dom.typeFilters.addEventListener('click', (e) => {
        const pill = e.target.closest('.pill');
        if (!pill) return;

        state.filters.activeType = pill.dataset.type;
        applyFilters();
        renderFilters();
      });

      // æœŸåˆŠç­›é€‰
      dom.venueFilters.addEventListener('click', (e) => {
        const pill = e.target.closest('.pill');
        if (!pill) return;

        state.filters.activeVenue = pill.dataset.venue;
        applyFilters();
        renderFilters();
      });

      // å¹´ä»½èŒƒå›´
      dom.yearStartRange.addEventListener('input', (e) => {
        const value = parseInt(e.target.value);
        state.filters.yearStart = value;
        dom.yearStartLabel.textContent = value;

        // ç¡®ä¿èµ·å§‹å¹´ä»½ä¸å¤§äºç»“æŸå¹´ä»½
        if (value > state.filters.yearEnd) {
          state.filters.yearEnd = value;
          dom.yearEndRange.value = value;
          dom.yearEndLabel.textContent = value;
        }

        applyFilters();
      });

      dom.yearEndRange.addEventListener('input', (e) => {
        const value = parseInt(e.target.value);
        state.filters.yearEnd = value;
        dom.yearEndLabel.textContent = value;

        // ç¡®ä¿ç»“æŸå¹´ä»½ä¸å°äºèµ·å§‹å¹´ä»½
        if (value < state.filters.yearStart) {
          state.filters.yearStart = value;
          dom.yearStartRange.value = value;
          dom.yearStartLabel.textContent = value;
        }

        applyFilters();
      });

      // æ“ä½œå›¾æ ‡ç‚¹å‡»
      dom.literatureGrid.addEventListener('click', (e) => {
        const icon = e.target.closest('.action-icon');
        if (!icon) return;

        e.stopPropagation();
        const card = icon.closest('.literature-card');
        const id = card.dataset.id;
        const action = icon.dataset.action;

        handleAction(action, id);
      });

      // å…³é”®è¯ç‚¹å‡»æœç´¢
      dom.literatureGrid.addEventListener('click', (e) => {
        const keywordTag = e.target.closest('.keyword-tag');
        if (!keywordTag) return;

        e.stopPropagation();
        const keyword = keywordTag.dataset.keyword;

        // è®¾ç½®æœç´¢å…³é”®è¯
        dom.searchInput.value = keyword;
        state.searchQuery = keyword;

        // æ‰§è¡Œæœç´¢
        applyFilters();

        // æ»šåŠ¨åˆ°é¡¶éƒ¨æŸ¥çœ‹ç»“æœ
        dom.mainLayout.scrollTo({ top: 0, behavior: 'smooth' });

        // æ˜¾ç¤ºæç¤º
        const count = state.filteredLiteratures.length;
        showToast(`ğŸ” æ‰¾åˆ° ${count} ç¯‡åŒ…å«ã€Œ${keyword}ã€çš„æ–‡çŒ®`);
      });

      // ç‚¹å‡»èƒŒæ™¯é®ç½©å…³é—­è¯¦æƒ…
      dom.backdropBlur.addEventListener('click', () => {
        if (state.expandedId) {
          state.expandedId = null;
          hideBackdrop();
          renderLiteratures();
        } else if (state.expandedAuthor) {
          state.expandedAuthor = null;
          hideBackdrop();
          renderAuthors();
        } else if (state.expandedJournal) {
          state.expandedJournal = null;
          hideBackdrop();
          renderJournals();
        }
      });

      // ESC é”®å…³é—­è¯¦æƒ…
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') {
          if (state.expandedId) {
            state.expandedId = null;
            hideBackdrop();
            renderLiteratures();
          } else if (state.expandedAuthor) {
            state.expandedAuthor = null;
            hideBackdrop();
            renderAuthors();
          } else if (state.expandedJournal) {
            state.expandedJournal = null;
            hideBackdrop();
            renderJournals();
          }
        }
      });

      // åŠ è½½ç¤ºä¾‹æ•°æ®ï¼ˆç”¨äºæµ‹è¯•ï¼‰
      loadSampleData();

      // é€šçŸ¥ Native å‡†å¤‡å°±ç»ª
      Bridge.notifyReady();
    }

    /**
     * åŠ è½½ç¤ºä¾‹æ•°æ®ï¼ˆæµ‹è¯•ç”¨ï¼‰
     */
    function loadSampleData() {
      const sampleData = [
        {
          id: 'zhang2023transformer',
          title: 'Transformer æ¨¡å‹åœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„çªç ´æ€§è¿›å±•',
          authors: ['å¼ ä¼Ÿ', 'ææ˜', 'Anna Wilson'],
          year: 2023,
          type: 'article',
          journal: 'äººå·¥æ™ºèƒ½å­¦æŠ¥',
          keywords: ['è‡ªç„¶è¯­è¨€å¤„ç†', 'Transformer', 'æ³¨æ„åŠ›æœºåˆ¶', 'æ·±åº¦å­¦ä¹ '],
          abstract: 'æœ¬æ–‡æ·±å…¥åˆ†æäº†Transformeræ¶æ„åœ¨è‡ªç„¶è¯­è¨€å¤„ç†é¢†åŸŸçš„é©å‘½æ€§å½±å“ã€‚é€šè¿‡å¯¹å¤šä¸ªå¤§è§„æ¨¡NLPä»»åŠ¡çš„å®éªŒè¯„ä¼°ï¼Œæˆ‘ä»¬è¯æ˜äº†Transformeræ¨¡å‹åœ¨å¤„ç†é•¿åºåˆ—å’Œè¯­ä¹‰ç†è§£æ–¹é¢çš„æ˜¾è‘—ä¼˜åŠ¿ã€‚',
          doi: '10.1000/ai.2023.001',
          citations: 128,
          pdfLink: 'marginnote://note/xxx'
        },
        {
          id: 'wang2022federated',
          title: 'è”é‚¦å­¦ä¹ åœ¨åŒ»ç–—å›¾åƒåˆ†æä¸­çš„éšç§ä¿æŠ¤åº”ç”¨',
          authors: ['ç‹èŠ³', 'Robert Davis', 'åˆ˜å¼º'],
          year: 2022,
          type: 'inproceedings',
          journal: 'å›½é™…åŒ»å­¦å½±åƒä¼šè®®',
          keywords: ['è”é‚¦å­¦ä¹ ', 'åŒ»ç–—å›¾åƒ', 'éšç§ä¿æŠ¤', 'æ·±åº¦å­¦ä¹ '],
          abstract: 'é’ˆå¯¹åŒ»ç–—æ•°æ®éšç§ä¿æŠ¤éœ€æ±‚ï¼Œæœ¬ç ”ç©¶æå‡ºäº†ä¸€ç§åŸºäºè”é‚¦å­¦ä¹ çš„åŒ»å­¦å›¾åƒåˆ†ææ¡†æ¶ã€‚è¯¥æ–¹æ¡ˆåœ¨ä¿æŒæ•°æ®æœ¬åœ°åŒ–çš„åŸºç¡€ä¸Šå®ç°äº†åˆ†å¸ƒå¼æ¨¡å‹è®­ç»ƒã€‚',
          citations: 89
        },
        {
          id: 'chen2021reinforcement',
          title: 'åŸºäºæ·±åº¦å¼ºåŒ–å­¦ä¹ çš„è‡ªåŠ¨é©¾é©¶å†³ç­–ç³»ç»Ÿ',
          authors: ['é™ˆæ˜', 'Steven Chen', 'èµµæ•'],
          year: 2021,
          type: 'article',
          journal: 'IEEE æ™ºèƒ½äº¤é€šç³»ç»Ÿ',
          keywords: ['è‡ªåŠ¨é©¾é©¶', 'å¼ºåŒ–å­¦ä¹ ', 'å†³ç­–ç³»ç»Ÿ', 'äººå·¥æ™ºèƒ½'],
          abstract: 'æœ¬æ–‡æå‡ºäº†ä¸€ç§ç»“åˆæ·±åº¦å¼ºåŒ–å­¦ä¹ çš„è‡ªåŠ¨é©¾é©¶å†³ç­–æ¡†æ¶ã€‚é€šè¿‡è®¾è®¡æ–°å‹å¥–åŠ±å‡½æ•°å’ŒçŠ¶æ€è¡¨ç¤ºæ–¹æ³•ï¼Œç³»ç»Ÿåœ¨å¤æ‚äº¤é€šåœºæ™¯ä¸­è¡¨ç°å‡ºä¼˜å¼‚çš„å†³ç­–èƒ½åŠ›ã€‚',
          doi: '10.1109/TITS.2021.xxx',
          citations: 145
        },
        {
          id: 'liu2020knowledge',
          title: 'çŸ¥è¯†å›¾è°±æ„å»ºä¸­çš„å®ä½“å¯¹é½æŠ€æœ¯ç ”ç©¶',
          authors: ['åˆ˜å»ºå', 'ç‹ä¼Ÿ', 'å¼ æ˜'],
          year: 2020,
          type: 'article',
          journal: 'è®¡ç®—æœºç ”ç©¶ä¸å‘å±•',
          keywords: ['çŸ¥è¯†å›¾è°±', 'å®ä½“å¯¹é½', 'å›¾ç¥ç»ç½‘ç»œ', 'è‡ªç„¶è¯­è¨€å¤„ç†'],
          abstract: 'æœ¬ç ”ç©¶ç³»ç»Ÿæ¢è®¨äº†å¤§è§„æ¨¡çŸ¥è¯†å›¾è°±æ„å»ºä¸­çš„å®ä½“å¯¹é½å…³é”®æŠ€æœ¯ã€‚æå‡ºäº†ä¸€ç§åŸºäºå›¾ç¥ç»ç½‘ç»œå’Œé¢„è®­ç»ƒè¯­è¨€æ¨¡å‹çš„è”åˆå­¦ä¹ æ–¹æ³•ã€‚',
          citations: 76
        },
        {
          id: 'huang2023compression',
          title: 'ç¥ç»ç½‘ç»œæ¨¡å‹å‹ç¼©ä¸åŠ é€ŸæŠ€æœ¯ç»¼è¿°',
          authors: ['Steven Chen', 'é»„ä¼Ÿ', 'Anna Wilson'],
          year: 2023,
          type: 'article',
          journal: 'IEEE æ¨¡å¼åˆ†æä¸æœºå™¨æ™ºèƒ½',
          keywords: ['æ¨¡å‹å‹ç¼©', 'ç¥ç»ç½‘ç»œ', 'æ¨¡å‹åŠ é€Ÿ', 'è¾¹ç¼˜è®¡ç®—'],
          abstract: 'æœ¬æ–‡å…¨é¢ç»¼è¿°äº†æ·±åº¦ç¥ç»ç½‘ç»œæ¨¡å‹å‹ç¼©ä¸åŠ é€Ÿçš„æœ€æ–°ç ”ç©¶è¿›å±•ã€‚ç³»ç»Ÿåˆ†æäº†å‰ªæã€é‡åŒ–ã€çŸ¥è¯†è’¸é¦å’Œè½»é‡åŒ–ç½‘ç»œè®¾è®¡ç­‰æŠ€æœ¯çš„åŸç†ä¸åº”ç”¨åœºæ™¯ã€‚',
          doi: '10.1109/TPAMI.2023.xxx',
          citations: 112
        },
        // ========== æ–°å¢æµ‹è¯•æ•°æ® ==========
        {
          id: 'li2023nlp',
          title: 'é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹åœ¨è·¨è¯­è¨€ç†è§£ä¸­çš„åº”ç”¨',
          authors: ['æå', 'Emily Zhang', 'ç‹ç£Š'],
          year: 2023,
          type: 'inproceedings',
          journal: 'ACL 2023',
          keywords: ['è‡ªç„¶è¯­è¨€å¤„ç†', 'Transformer', 'è·¨è¯­è¨€å­¦ä¹ ', 'é¢„è®­ç»ƒæ¨¡å‹'],
          abstract: 'æœ¬æ–‡æ¢è®¨äº†é¢„è®­ç»ƒè¯­è¨€æ¨¡å‹åœ¨è·¨è¯­è¨€ç†è§£ä»»åŠ¡ä¸­çš„åº”ç”¨ã€‚é€šè¿‡è®¾è®¡æ–°å‹çš„è·¨è¯­è¨€å¯¹é½æœºåˆ¶ï¼Œæˆ‘ä»¬çš„æ¨¡å‹åœ¨å¤šä¸ªåŸºå‡†æµ‹è¯•ä¸­å–å¾—äº†æ˜¾è‘—æå‡ã€‚',
          doi: '10.18653/v1/2023.acl-long.123',
          citations: 67
        },
        {
          id: 'zhao2022vision',
          title: 'è§†è§‰ Transformer åœ¨åŒ»ç–—å½±åƒåˆ†æä¸­çš„ç ”ç©¶',
          authors: ['èµµä¸½', 'John Smith', 'é™ˆå¼º'],
          year: 2022,
          type: 'article',
          journal: 'Medical Image Analysis',
          keywords: ['æ·±åº¦å­¦ä¹ ', 'Transformer', 'åŒ»ç–—å›¾åƒ', 'è®¡ç®—æœºè§†è§‰'],
          abstract: 'å°† Vision Transformer åº”ç”¨äºåŒ»å­¦å½±åƒåˆ†æï¼Œç‰¹åˆ«æ˜¯åœ¨è‚¿ç˜¤æ£€æµ‹å’Œç—…å˜åˆ†å‰²ä»»åŠ¡ä¸­ã€‚å®éªŒè¡¨æ˜ ViT åœ¨å¤„ç†é«˜åˆ†è¾¨ç‡åŒ»å­¦å›¾åƒæ—¶å…·æœ‰æ˜æ˜¾ä¼˜åŠ¿ã€‚',
          doi: '10.1016/j.media.2022.102456',
          citations: 89
        },
        {
          id: 'wu2024multimodal',
          title: 'å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹çš„è§†è§‰æ¨ç†èƒ½åŠ›ç ”ç©¶',
          authors: ['å´æ˜', 'Sarah Lee', 'å¼ é¹'],
          year: 2024,
          type: 'inproceedings',
          journal: 'CVPR 2024',
          keywords: ['æ·±åº¦å­¦ä¹ ', 'å¤šæ¨¡æ€å­¦ä¹ ', 'Transformer', 'è§†è§‰æ¨ç†'],
          abstract: 'ç ”ç©¶å¤šæ¨¡æ€å¤§è¯­è¨€æ¨¡å‹åœ¨è§†è§‰æ¨ç†ä»»åŠ¡ä¸­çš„è¡¨ç°ï¼Œæå‡ºäº†ä¸€ç§æ–°çš„è§†è§‰-è¯­è¨€å¯¹é½æ–¹æ³•ï¼Œæ˜¾è‘—æå‡äº†æ¨¡å‹çš„æ¨ç†èƒ½åŠ›ã€‚',
          citations: 34
        },
        {
          id: 'sun2021attention',
          title: 'æ³¨æ„åŠ›æœºåˆ¶åœ¨æ—¶åºé¢„æµ‹ä¸­çš„åº”ç”¨ç»¼è¿°',
          authors: ['å­™ä¼Ÿ', 'Michael Brown'],
          year: 2021,
          type: 'article',
          journal: 'IEEE Transactions on Neural Networks',
          keywords: ['æ³¨æ„åŠ›æœºåˆ¶', 'æ—¶åºé¢„æµ‹', 'æ·±åº¦å­¦ä¹ ', 'Transformer'],
          abstract: 'å…¨é¢ç»¼è¿°äº†æ³¨æ„åŠ›æœºåˆ¶åœ¨æ—¶åºé¢„æµ‹é¢†åŸŸçš„åº”ç”¨è¿›å±•ï¼ŒåŒ…æ‹¬ Transformerã€æ—¶é—´æ³¨æ„åŠ›ç½‘ç»œç­‰æ¶æ„çš„åŸç†å’Œåº”ç”¨åœºæ™¯ã€‚',
          doi: '10.1109/TNNLS.2021.3089456',
          citations: 156
        },
        {
          id: 'tang2023robotics',
          title: 'æ·±åº¦å¼ºåŒ–å­¦ä¹ åœ¨æœºå™¨äººæ“æ§ä»»åŠ¡ä¸­çš„åº”ç”¨',
          authors: ['å”è‰', 'David Kim', 'æ—å¼º'],
          year: 2023,
          type: 'inproceedings',
          journal: 'ICRA 2023',
          keywords: ['å¼ºåŒ–å­¦ä¹ ', 'æœºå™¨äºº', 'æ·±åº¦å­¦ä¹ ', 'æ“æ§ç³»ç»Ÿ'],
          abstract: 'æå‡ºäº†ä¸€ç§åŸºäºæ·±åº¦å¼ºåŒ–å­¦ä¹ çš„æœºå™¨äººæ“æ§æ¡†æ¶ï¼Œé€šè¿‡æ¨¡ä»¿å­¦ä¹ å’Œåœ¨çº¿å¼ºåŒ–å­¦ä¹ çš„ç»“åˆï¼Œå®ç°äº†å¤æ‚æ“æ§ä»»åŠ¡çš„å¿«é€Ÿå­¦ä¹ ã€‚',
          citations: 45
        },
        {
          id: 'ma2022graph',
          title: 'å›¾ç¥ç»ç½‘ç»œåœ¨ç¤¾äº¤ç½‘ç»œåˆ†æä¸­çš„æœ€æ–°è¿›å±•',
          authors: ['é©¬æ¶›', 'Jennifer Wang', 'å‘¨æ•'],
          year: 2022,
          type: 'article',
          journal: 'ACM Computing Surveys',
          keywords: ['å›¾ç¥ç»ç½‘ç»œ', 'ç¤¾äº¤ç½‘ç»œ', 'æ·±åº¦å­¦ä¹ ', 'ç½‘ç»œåˆ†æ'],
          abstract: 'ç³»ç»Ÿå›é¡¾äº†å›¾ç¥ç»ç½‘ç»œåœ¨ç¤¾äº¤ç½‘ç»œåˆ†æä¸­çš„åº”ç”¨ï¼ŒåŒ…æ‹¬ç¤¾åŒºå‘ç°ã€å½±å“åŠ›ä¼ æ’­ã€é“¾è·¯é¢„æµ‹ç­‰ä»»åŠ¡çš„æœ€æ–°ç ”ç©¶è¿›å±•ã€‚',
          doi: '10.1145/3522771',
          citations: 203
        },
        {
          id: 'xu2024edge',
          title: 'è¾¹ç¼˜è®¡ç®—ç¯å¢ƒä¸‹çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ä¼˜åŒ–',
          authors: ['å¾åˆš', 'Lisa Chen'],
          year: 2024,
          type: 'article',
          journal: 'IEEE Internet of Things Journal',
          keywords: ['è¾¹ç¼˜è®¡ç®—', 'æ·±åº¦å­¦ä¹ ', 'æ¨¡å‹å‹ç¼©', 'æ¨¡å‹åŠ é€Ÿ'],
          abstract: 'é’ˆå¯¹è¾¹ç¼˜è®¾å¤‡èµ„æºå—é™çš„ç‰¹ç‚¹ï¼Œæå‡ºäº†ä¸€å¥—å®Œæ•´çš„æ·±åº¦å­¦ä¹ æ¨¡å‹ä¼˜åŒ–æ–¹æ¡ˆï¼ŒåŒ…æ‹¬é‡åŒ–ã€å‰ªæå’ŒçŸ¥è¯†è’¸é¦ç­‰æŠ€æœ¯ã€‚',
          doi: '10.1109/JIOT.2024.3356789',
          citations: 28
        },
        {
          id: 'qian2021privacy',
          title: 'è”é‚¦å­¦ä¹ ä¸­çš„å·®åˆ†éšç§ä¿æŠ¤æœºåˆ¶',
          authors: ['é’±çº¢', 'Andrew Miller', 'å®‹ä¼Ÿ'],
          year: 2021,
          type: 'inproceedings',
          journal: 'NeurIPS 2021',
          keywords: ['è”é‚¦å­¦ä¹ ', 'éšç§ä¿æŠ¤', 'å·®åˆ†éšç§', 'æœºå™¨å­¦ä¹ '],
          abstract: 'ç ”ç©¶è”é‚¦å­¦ä¹ åœºæ™¯ä¸‹çš„éšç§ä¿æŠ¤é—®é¢˜ï¼Œæå‡ºäº†ä¸€ç§é«˜æ•ˆçš„å·®åˆ†éšç§æœºåˆ¶ï¼Œåœ¨ä¿è¯éšç§çš„åŒæ—¶æœ€å°åŒ–æ€§èƒ½æŸå¤±ã€‚',
          citations: 98
        },
        {
          id: 'ding2023adversarial',
          title: 'å¯¹æŠ—è®­ç»ƒåœ¨è‡ªç„¶è¯­è¨€å¤„ç†ä¸­çš„é²æ£’æ€§ç ”ç©¶',
          authors: ['ä¸ç£Š', 'Rebecca White', 'ä½•æ•'],
          year: 2023,
          type: 'article',
          journal: 'Computational Linguistics',
          keywords: ['è‡ªç„¶è¯­è¨€å¤„ç†', 'å¯¹æŠ—è®­ç»ƒ', 'é²æ£’æ€§', 'æ·±åº¦å­¦ä¹ '],
          abstract: 'æ·±å…¥ç ”ç©¶å¯¹æŠ—è®­ç»ƒæ–¹æ³•åœ¨æå‡ NLP æ¨¡å‹é²æ£’æ€§æ–¹é¢çš„ä½œç”¨ï¼Œæå‡ºäº†å¤šç§é’ˆå¯¹æ–‡æœ¬æ•°æ®çš„å¯¹æŠ—æ ·æœ¬ç”Ÿæˆç­–ç•¥ã€‚',
          doi: '10.1162/coli_a_00456',
          citations: 72
        },
        {
          id: 'gao2022semantic',
          title: 'åŸºäºè¯­ä¹‰ç†è§£çš„å›¾åƒåˆ†å‰²æ–°æ–¹æ³•',
          authors: ['é«˜é™', 'Thomas Anderson'],
          year: 2022,
          type: 'inproceedings',
          journal: 'ECCV 2022',
          keywords: ['è®¡ç®—æœºè§†è§‰', 'å›¾åƒåˆ†å‰²', 'è¯­ä¹‰ç†è§£', 'æ·±åº¦å­¦ä¹ '],
          abstract: 'æå‡ºäº†ä¸€ç§ç»“åˆè¯­ä¹‰ç†è§£çš„å›¾åƒåˆ†å‰²æ–¹æ³•ï¼Œé€šè¿‡å¼•å…¥è¯­è¨€å…ˆéªŒçŸ¥è¯†ï¼Œæ˜¾è‘—æå‡äº†åˆ†å‰²çš„å‡†ç¡®æ€§å’Œä¸€è‡´æ€§ã€‚',
          citations: 81
        },
        {
          id: 'pan2020survey',
          title: 'è¿ç§»å­¦ä¹ ç†è®ºä¸åº”ç”¨ç ”ç©¶ç»¼è¿°',
          authors: ['æ½˜ä¼Ÿ', 'æ¨æ•', 'Kevin Lee'],
          year: 2020,
          type: 'article',
          journal: 'IEEE Transactions on Knowledge and Data Engineering',
          keywords: ['è¿ç§»å­¦ä¹ ', 'æ·±åº¦å­¦ä¹ ', 'é¢†åŸŸé€‚åº”', 'æœºå™¨å­¦ä¹ '],
          abstract: 'å…¨é¢ç»¼è¿°äº†è¿ç§»å­¦ä¹ çš„ç†è®ºåŸºç¡€å’Œå®é™…åº”ç”¨ï¼Œæ¶µç›–äº†é¢†åŸŸé€‚åº”ã€ä»»åŠ¡è¿ç§»ã€é›¶æ ·æœ¬å­¦ä¹ ç­‰å¤šä¸ªæ–¹é¢ã€‚',
          doi: '10.1109/TKDE.2020.2987980',
          citations: 267
        },
        // ========== æ•°å­¦é¢†åŸŸæœŸåˆŠæµ‹è¯•æ•°æ® ==========
        {
          id: 'wang2023annals',
          title: 'On the Riemann Hypothesis and Prime Number Distribution',
          authors: ['ç‹å»º', 'Peter Smith', 'æå'],
          year: 2023,
          type: 'article',
          journal: 'ANNALS OF MATHEMATICS',
          keywords: ['æ•°è®º', 'é»æ›¼çŒœæƒ³', 'ç´ æ•°åˆ†å¸ƒ', 'è§£ææ•°è®º'],
          abstract: 'æœ¬æ–‡ç ”ç©¶äº†é»æ›¼çŒœæƒ³ä¸ç´ æ•°åˆ†å¸ƒä¹‹é—´çš„æ·±å±‚è”ç³»ã€‚é€šè¿‡å¼•å…¥æ–°çš„è§£ææ–¹æ³•ï¼Œæˆ‘ä»¬å¯¹é»æ›¼ Î¶ å‡½æ•°çš„é›¶ç‚¹åˆ†å¸ƒç»™å‡ºäº†æ›´ç²¾ç¡®çš„ä¼°è®¡ã€‚',
          doi: '10.4007/annals.2023.197.1.1',
          citations: 234
        },
        {
          id: 'liu2022advances',
          title: 'Advances in Algebraic Topology and Homotopy Theory',
          authors: ['åˆ˜æ˜', 'Anna Wilson'],
          year: 2022,
          type: 'article',
          journal: 'ADVANCES IN MATHEMATICS',
          keywords: ['ä»£æ•°æ‹“æ‰‘', 'åŒä¼¦è®º', 'èŒƒç•´è®º', 'æ‹“æ‰‘å­¦'],
          abstract: 'æˆ‘ä»¬å‘å±•äº†ä¸€å¥—æ–°çš„ä»£æ•°æ‹“æ‰‘å·¥å…·æ¥ç ”ç©¶åŒä¼¦ç¾¤çš„è®¡ç®—é—®é¢˜ã€‚è¿™äº›æ–¹æ³•åœ¨è®¡ç®—é«˜ç»´çƒé¢çš„åŒä¼¦ç¾¤æ—¶ç‰¹åˆ«æœ‰æ•ˆã€‚',
          doi: '10.1016/j.aim.2022.108123',
          citations: 156
        },
        {
          id: 'zhang2024china',
          title: 'Nonlinear Partial Differential Equations on Manifolds',
          authors: ['å¼ ä¼Ÿ', 'é™ˆæ˜', 'Robert Johnson'],
          year: 2024,
          type: 'article',
          journal: 'SCIENCE CHINA-MATHEMATICS',
          keywords: ['åå¾®åˆ†æ–¹ç¨‹', 'æµå½¢', 'å‡ ä½•åˆ†æ', 'éçº¿æ€§åˆ†æ'],
          abstract: 'æœ¬æ–‡ç ”ç©¶äº†æµå½¢ä¸Šçš„éçº¿æ€§åå¾®åˆ†æ–¹ç¨‹è§£çš„å­˜åœ¨æ€§å’Œå”¯ä¸€æ€§é—®é¢˜ã€‚æˆ‘ä»¬è¯æ˜äº†åœ¨ç´§è‡´é»æ›¼æµå½¢ä¸Šï¼ŒæŸç±»æ¤­åœ†æ–¹ç¨‹å…·æœ‰å…‰æ»‘è§£ã€‚',
          doi: '10.1007/s11425-024-2056-3',
          citations: 89
        },
        {
          id: 'chen2023algebra',
          title: 'Representation Theory of Finite Groups',
          authors: ['é™ˆå¼º', 'David Miller'],
          year: 2023,
          type: 'article',
          journal: 'JOURNAL OF ALGEBRA',
          keywords: ['ç¾¤è¡¨ç¤ºè®º', 'æœ‰é™ç¾¤', 'ä»£æ•°', 'ç‰¹å¾æ ‡ç†è®º'],
          abstract: 'æˆ‘ä»¬ç ”ç©¶äº†æœ‰é™ç¾¤çš„å¤è¡¨ç¤ºç†è®ºï¼Œç‰¹åˆ«å…³æ³¨ä¸å¯çº¦è¡¨ç¤ºçš„æ„é€ å’Œåˆ†ç±»é—®é¢˜ã€‚ç»™å‡ºäº†æŸäº›é‡è¦ç¾¤ç±»çš„å®Œæ•´ç‰¹å¾æ ‡è¡¨ã€‚',
          doi: '10.1016/j.jalgebra.2023.04.012',
          citations: 67
        },
        {
          id: 'yang2022calculus',
          title: 'Calculus of Variations and Optimal Control',
          authors: ['æ¨ç£Š', 'Sarah Lee', 'èµµæ•'],
          year: 2022,
          type: 'article',
          journal: 'CALCULUS OF VARIATIONS AND PARTIAL DIFFERENTIAL EQUATIONS',
          keywords: ['å˜åˆ†æ³•', 'æœ€ä¼˜æ§åˆ¶', 'æ³›å‡½åˆ†æ', 'åå¾®åˆ†æ–¹ç¨‹'],
          abstract: 'æœ¬æ–‡å»ºç«‹äº†ä¸€ä¸ªç»Ÿä¸€çš„æ¡†æ¶æ¥å¤„ç†å˜åˆ†é—®é¢˜å’Œæœ€ä¼˜æ§åˆ¶é—®é¢˜ã€‚æˆ‘ä»¬è¯æ˜äº†åœ¨ä¸€èˆ¬å‡è®¾ä¸‹è§£çš„å­˜åœ¨æ€§å®šç†ã€‚',
          doi: '10.1007/s00526-022-02345-6',
          citations: 78
        },
        {
          id: 'zhao2021fundamental',
          title: 'Fundamentals of Mathematical Logic and Set Theory',
          authors: ['èµµå»ºå', 'Michael Brown'],
          year: 2021,
          type: 'article',
          journal: 'FUNDAMENTA MATHEMATICAE',
          keywords: ['æ•°ç†é€»è¾‘', 'é›†åˆè®º', 'æ¨¡å‹è®º', 'è¯æ˜è®º'],
          abstract: 'æˆ‘ä»¬å‘å±•äº†ä¸€ä¸ªæ–°çš„é›†åˆè®ºæ¨¡å‹ï¼Œåœ¨å…¶ä¸­æŸäº›ç»å…¸çš„ç‹¬ç«‹æ€§ç»“æœå¯ä»¥è¢«è§£å†³ã€‚è¿™ä¸ºé›†åˆè®ºçš„åŸºç¡€ç ”ç©¶æä¾›äº†æ–°çš„è§†è§’ã€‚',
          doi: '10.4064/fm123-4-5678',
          citations: 45
        },
        {
          id: 'li2024linear',
          title: 'Linear Algebra and Matrix Theory Applications',
          authors: ['æé™', 'Thomas Anderson', 'å´æ˜'],
          year: 2024,
          type: 'article',
          journal: 'LINEAR ALGEBRA AND ITS APPLICATIONS',
          keywords: ['çº¿æ€§ä»£æ•°', 'çŸ©é˜µè®º', 'æ•°å€¼åˆ†æ', 'ç‰¹å¾å€¼é—®é¢˜'],
          abstract: 'æœ¬æ–‡æå‡ºäº†ä¸€ç§æ–°çš„ç®—æ³•æ¥è®¡ç®—å¤§è§„æ¨¡ç¨€ç–çŸ©é˜µçš„ç‰¹å¾å€¼ã€‚è¯¥ç®—æ³•åœ¨å®é™…åº”ç”¨ä¸­è¡¨ç°å‡ºä¼˜å¼‚çš„æ”¶æ•›æ€§å’Œç¨³å®šæ€§ã€‚',
          doi: '10.1016/j.laa.2024.01.001',
          citations: 52
        },
        {
          id: 'sun2023acta',
          title: 'Harmonic Analysis on Lie Groups',
          authors: ['å­™ä¼Ÿ', 'Jennifer Wang'],
          year: 2023,
          type: 'article',
          journal: 'ACTA MATHEMATICA SINICA-ENGLISH SERIES',
          keywords: ['è°ƒå’Œåˆ†æ', 'æç¾¤', 'è¡¨ç¤ºè®º', 'å‚…é‡Œå¶åˆ†æ'],
          abstract: 'æˆ‘ä»¬ç ”ç©¶äº†æç¾¤ä¸Šçš„è°ƒå’Œåˆ†æç†è®ºï¼Œç‰¹åˆ«æ˜¯ Peter-Weyl å®šç†åœ¨ç´§æç¾¤ä¸Šçš„æ¨å¹¿ã€‚å»ºç«‹äº†ä¸è¡¨ç¤ºè®ºä¹‹é—´çš„æ·±åˆ»è”ç³»ã€‚',
          doi: '10.1007/s10114-023-1234-5',
          citations: 61
        }
      ];

      Bridge.loadLiteratures({ literatures: sampleData });
    }

    // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }

    // æš´éœ² handleAction åˆ°å…¨å±€ï¼ˆç”¨äºæŒ‰é’®ç‚¹å‡»ï¼‰
    window.handleAction = handleAction;
  </script>
</body>
</html>
